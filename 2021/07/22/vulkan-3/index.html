<!DOCTYPE html>
<html lang="ru-RU"><head>
	    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="profile" href="http://gmpg.org/xfn/11">
    <link rel="pingback" href="/blog/xmlrpc.php">
    
<title>Vulkan Learning &mdash; 3. Swapchain. Depth Buffer. Render Pass. Framebuffers &mdash; Dmitry's Blog</title>
<meta name="robots" content="max-image-preview:large">
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="alternate" type="application/rss+xml" title="Dmitry's Blog &raquo; &#1051;&#1077;&#1085;&#1090;&#1072;" href="/blog/feed/">
<link rel="alternate" type="application/rss+xml" title="Dmitry's Blog &raquo; &#1051;&#1077;&#1085;&#1090;&#1072; &#1082;&#1086;&#1084;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1080;&#1077;&#1074;" href="/blog/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Dmitry's Blog &raquo; &#1051;&#1077;&#1085;&#1090;&#1072; &#1082;&#1086;&#1084;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1080;&#1077;&#1074; &#1082; &laquo;Vulkan Learning &mdash; 3. Swapchain. Depth Buffer. Render Pass. Framebuffers&raquo;" href="/blog/2021/07/22/vulkan-3/feed/">
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/16.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/16.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/localhost\/dvsav.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.8.2"}};
/*! This file is auto-generated */
!function(s,n){var o,i,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),a=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===a[t]})}function u(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);for(var n=e.getImageData(16,16,1,1),a=0;a<n.data.length;a++)if(0!==n.data[a])return!1;return!0}function f(e,t,n,a){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\udde8\ud83c\uddf6","\ud83c\udde8\u200b\ud83c\uddf6")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!a(e,"\ud83e\udedf")}return!1}function g(e,t,n,a){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):s.createElement("canvas"),o=r.getContext("2d",{willReadFrequently:!0}),i=(o.textBaseline="top",o.font="600 32px Arial",{});return e.forEach(function(e){i[e]=t(o,e,n,a)}),i}function t(e){var t=s.createElement("script");t.src=e,t.defer=!0,s.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",i=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){s.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+g.toString()+"("+[JSON.stringify(i),f.toString(),p.toString(),u.toString()].join(",")+"));",a=new Blob([e],{type:"text/javascript"}),r=new Worker(URL.createObjectURL(a),{name:"wpTestEmojiSupports"});return void(r.onmessage=function(e){c(n=e.data),r.terminate(),t(n)})}catch(e){}c(n=g(i,f,p,u))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id="wp-emoji-styles-inline-css" type="text/css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel="stylesheet" id="wp-block-library-css" href="/blog/wp-includes/css/dist/block-library/style.min.css?ver=6.8.2" type="text/css" media="all">
<style id="wp-block-library-theme-inline-css" type="text/css">
.wp-block-audio :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-audio :where(figcaption){color:#ffffffa6}.wp-block-audio{margin:0 0 1em}.wp-block-code{border:1px solid #ccc;border-radius:4px;font-family:Menlo,Consolas,monaco,monospace;padding:.8em 1em}.wp-block-embed :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-embed :where(figcaption){color:#ffffffa6}.wp-block-embed{margin:0 0 1em}.blocks-gallery-caption{color:#555;font-size:13px;text-align:center}.is-dark-theme .blocks-gallery-caption{color:#ffffffa6}:root :where(.wp-block-image figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme :root :where(.wp-block-image figcaption){color:#ffffffa6}.wp-block-image{margin:0 0 1em}.wp-block-pullquote{border-bottom:4px solid;border-top:4px solid;color:currentColor;margin-bottom:1.75em}.wp-block-pullquote cite,.wp-block-pullquote footer,.wp-block-pullquote__citation{color:currentColor;font-size:.8125em;font-style:normal;text-transform:uppercase}.wp-block-quote{border-left:.25em solid;margin:0 0 1.75em;padding-left:1em}.wp-block-quote cite,.wp-block-quote footer{color:currentColor;font-size:.8125em;font-style:normal;position:relative}.wp-block-quote:where(.has-text-align-right){border-left:none;border-right:.25em solid;padding-left:0;padding-right:1em}.wp-block-quote:where(.has-text-align-center){border:none;padding-left:0}.wp-block-quote.is-large,.wp-block-quote.is-style-large,.wp-block-quote:where(.is-style-plain){border:none}.wp-block-search .wp-block-search__label{font-weight:700}.wp-block-search__button{border:1px solid #ccc;padding:.375em .625em}:where(.wp-block-group.has-background){padding:1.25em 2.375em}.wp-block-separator.has-css-opacity{opacity:.4}.wp-block-separator{border:none;border-bottom:2px solid;margin-left:auto;margin-right:auto}.wp-block-separator.has-alpha-channel-opacity{opacity:1}.wp-block-separator:not(.is-style-wide):not(.is-style-dots){width:100px}.wp-block-separator.has-background:not(.is-style-dots){border-bottom:none;height:1px}.wp-block-separator.has-background:not(.is-style-wide):not(.is-style-dots){height:2px}.wp-block-table{margin:0 0 1em}.wp-block-table td,.wp-block-table th{word-break:normal}.wp-block-table :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-table :where(figcaption){color:#ffffffa6}.wp-block-video :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-video :where(figcaption){color:#ffffffa6}.wp-block-video{margin:0 0 1em}:root :where(.wp-block-template-part.has-background){margin-bottom:0;margin-top:0;padding:1.25em 2.375em}
</style>
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--gray: #666666;--wp--preset--color--light-gray: #f3f3f3;--wp--preset--color--dark-gray: #222222;--wp--preset--color--blue: #294a70;--wp--preset--color--dark-blue: #15305b;--wp--preset--color--navy-blue: #00387d;--wp--preset--color--sky-blue: #49688e;--wp--preset--color--light-blue: #6081a7;--wp--preset--color--yellow: #f4a024;--wp--preset--color--dark-yellow: #ffab1f;--wp--preset--color--red: #e4572e;--wp--preset--color--green: #54b77e;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 28px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 16px;--wp--preset--font-size--huge: 32px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="contact-form-7-css" href="/blog/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=6.1.1" type="text/css" media="all">
<link rel="stylesheet" id="fontawesome-css" href="/blog/wp-content/themes/education-hub/third-party/font-awesome/css/all.min.css?ver=6.7.2" type="text/css" media="all">
<link rel="stylesheet" id="education-hub-google-fonts-css" href="//fonts.googleapis.com/css?family=Open+Sans%3A600%2C400%2C400italic%2C300%2C100%2C700%7CMerriweather+Sans%3A400%2C700&amp;ver=6.8.2" type="text/css" media="all">
<link rel="stylesheet" id="education-hub-style-css" href="/blog/wp-content/themes/education-hub/style.css?ver=3.0" type="text/css" media="all">
<link rel="stylesheet" id="education-hub-block-style-css" href="/blog/wp-content/themes/education-hub/css/blocks.css?ver=20201208" type="text/css" media="all">
<link rel="stylesheet" id="codecolorer-css" href="/blog/wp-content/plugins/codecolorer/codecolorer.css?ver=0.10.1" type="text/css" media="screen">
<script type="text/javascript" src="/blog/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="/blog/wp-json/"><link rel="alternate" title="JSON" type="application/json" href="/blog/wp-json/wp/v2/posts/1733"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/blog/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.8.2">
<link rel="canonical" href="/blog/2021/07/22/vulkan-3/">
<link rel="shortlink" href="/blog/?p=1733">
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="/blog/wp-json/oembed/1.0/embed?url=%2Fblog%2F2021%2F07%2F22%2Fvulkan-3%2F">
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="/blog/wp-json/oembed/1.0/embed?url=%2Fblog%2F2021%2F07%2F22%2Fvulkan-3%2F&amp;format=xml">
<link rel="icon" href="/blog/wp-content/uploads/2020/02/%D0%BA%D0%B0%D1%80%D0%B0%D0%BD%D0%B4%D0%B0%D1%88_%D1%81%D0%B6%D0%B0%D1%82-150x150.png" sizes="32x32">
<link rel="icon" href="/blog/wp-content/uploads/2020/02/%D0%BA%D0%B0%D1%80%D0%B0%D0%BD%D0%B4%D0%B0%D1%88_%D1%81%D0%B6%D0%B0%D1%82-270x270.png" sizes="192x192">
<link rel="apple-touch-icon" href="/blog/wp-content/uploads/2020/02/%D0%BA%D0%B0%D1%80%D0%B0%D0%BD%D0%B4%D0%B0%D1%88_%D1%81%D0%B6%D0%B0%D1%82-270x270.png">
<meta name="msapplication-TileImage" content="/blog/wp-content/uploads/2020/02/&#1082;&#1072;&#1088;&#1072;&#1085;&#1076;&#1072;&#1096;_&#1089;&#1078;&#1072;&#1090;-270x270.png">
		<style type="text/css" id="wp-custom-css">
			.entry-content a:link {
  text-decoration: underline; 
}		</style>
		</head>

<body class="wp-singular post-template-default single single-post postid-1733 single-format-standard wp-custom-logo wp-embed-responsive wp-theme-education-hub site-layout-fluid global-layout-right-sidebar">

	
	    <div id="page" class="container hfeed site">
    <a class="skip-link screen-reader-text" href="#content">&#1055;&#1077;&#1088;&#1077;&#1081;&#1090;&#1080; &#1082; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1084;&#1086;&#1084;&#1091;</a>
    	<div id="tophead">
		<div class="container">
			<div id="quick-contact">
				
							</div>

			
			
		</div> <!-- .container -->
	</div><!--  #tophead -->

	<header id="masthead" class="site-header" role="banner"><div class="container">			    <div class="site-branding">

		    <a href="/blog/" class="custom-logo-link" rel="home"><img width="150" height="150" src="/blog/wp-content/uploads/2020/02/pencil-compressed.png" class="custom-logo" alt="Dmitry's Blog" decoding="async" srcset="/blog/wp-content/uploads/2020/02/pencil-compressed.png 150w, /blog/wp-content/uploads/2020/02/&#1082;&#1072;&#1088;&#1072;&#1085;&#1076;&#1072;&#1096;_&#1089;&#1078;&#1072;&#1090;-270x270.png 270w, /blog/wp-content/uploads/2020/02/&#1082;&#1072;&#1088;&#1072;&#1085;&#1076;&#1072;&#1096;_&#1089;&#1078;&#1072;&#1090;-300x300.png 300w, /blog/wp-content/uploads/2020/02/&#1082;&#1072;&#1088;&#1072;&#1085;&#1076;&#1072;&#1096;_&#1089;&#1078;&#1072;&#1090;-768x768.png 768w" sizes="(max-width: 150px) 100vw, 150px"></a>
										        <div id="site-identity">
					            	              <p class="site-title"><a href="/blog/" rel="home">Dmitry's Blog</a></p>
	            				
					        </div><!-- #site-identity -->
			
	    </div><!-- .site-branding -->

	    	    		    <div class="search-section">
		    	<form role="search" method="get" class="search-form" action="/blog/">
	      <label>
	        <span class="screen-reader-text">&#1055;&#1086;&#1080;&#1089;&#1082; &#1087;&#1086;:</span>
	        <input type="search" class="search-field" placeholder="&#1055;&#1086;&#1080;&#1089;&#1082;&hellip;" value="" name="s" title="&#1055;&#1086;&#1080;&#1089;&#1082; &#1087;&#1086;:">
	      </label>
	      <input type="submit" class="search-submit" value="&#1055;&#1086;&#1080;&#1089;&#1082;">
	    </form>		    </div>
	    
        </div><!-- .container --></header><!-- #masthead -->    <div id="main-nav" class="clear-fix">
        <div class="container">
        <nav id="site-navigation" class="main-navigation" role="navigation">
          <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
          	<i class="fa fa-bars"></i>
          	<i class="fa fa-close"></i>
			&#1052;&#1077;&#1085;&#1102;</button>
            <div class="wrap-menu-content">
				<ul><li><a href="/blog/">&#1043;&#1083;&#1072;&#1074;&#1085;&#1072;&#1103;</a></li><li class="page_item page-item-387"><a href="/blog/aboutme/">&#1054; &#1089;&#1077;&#1073;&#1077;</a></li>
</ul>            </div><!-- .menu-content -->
        </nav><!-- #site-navigation -->
       </div> <!-- .container -->
    </div> <!-- #main-nav -->
    
	<div id="content" class="site-content"><div class="container"><div class="inner-wrapper">    
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-1733" class="post-1733 post type-post status-publish format-standard hentry category-1 tag-c-c tag-vulkan">
	<header class="entry-header">
		<h1 class="entry-title">Vulkan Learning &mdash; 3. Swapchain. Depth Buffer. Render Pass. Framebuffers</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="/blog/2021/07/22/vulkan-3/" rel="bookmark"><time class="entry-date published updated" datetime="2021-07-22T20:29:09+03:00">22.07.2021</time></a></span><span class="byline"> <span class="author vcard"><a class="url fn n" href="/blog/author/dvsav/">dvsav</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
    		<p>&#1056;&#1077;&#1095;&#1100; &#1087;&#1086;&#1081;&#1076;&#1077;&#1090; &#1086;&#1073; &#1080;&#1085;&#1092;&#1088;&#1072;&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1077; &#1087;&#1088;&#1077;&#1076;&#1085;&#1072;&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1085;&#1086;&#1081; &#1089;&#1091;&#1075;&#1091;&#1073;&#1086; &#1076;&#1083;&#1103; &#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1082;&#1080; &#1080; &#1086;&#1090;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &#1075;&#1088;&#1072;&#1092;&#1080;&#1082;&#1080; &#1085;&#1072; &#1101;&#1082;&#1088;&#1072;&#1085;&#1077;. &#1053;&#1072;&#1087;&#1086;&#1084;&#1085;&#1080;&#1084;, &#1095;&#1090;&#1086; &#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1082;&#1072; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &#1089;&#1091;&#1090;&#1100; &#1087;&#1088;&#1080;&#1089;&#1074;&#1072;&#1080;&#1074;&#1072;&#1085;&#1080;&#1077; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1081; &#1074;&#1089;&#1077;&#1084; &#1077;&#1075;&#1086; &#1087;&#1080;&#1082;&#1089;&#1077;&#1083;&#1103;&#1084;. &#1048;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077; &#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1089;&#1103; &#1074; &#1086;&#1087;&#1077;&#1088;&#1072;&#1090;&#1080;&#1074;&#1085;&#1086;&#1081; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;, &#1072;, &#1073;&#1091;&#1076;&#1091;&#1095;&#1080; &#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1084;, &#1086;&#1090;&#1086;&#1073;&#1088;&#1072;&#1078;&#1072;&#1077;&#1090;&#1089;&#1103; &#1085;&#1072; &#1101;&#1082;&#1088;&#1072;&#1085;&#1077; &#1084;&#1086;&#1085;&#1080;&#1090;&#1086;&#1088;&#1072;. &#1059;&#1095;&#1072;&#1089;&#1090;&#1086;&#1082; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;, &#1074; &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1084; &#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1089;&#1103; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077;, &#1095;&#1072;&#1089;&#1090;&#1086; &#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103; &#1092;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1084;. &#1058;&#1088;&#1072;&#1076;&#1080;&#1094;&#1080;&#1086;&#1085;&#1085;&#1086; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103; &#1082;&#1072;&#1082; &#1084;&#1080;&#1085;&#1080;&#1084;&#1091;&#1084; &#1076;&#1074;&#1072; &#1092;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &mdash; &#1086;&#1076;&#1080;&#1085; &#1080;&#1079; &#1085;&#1080;&#1093; &#1086;&#1090;&#1086;&#1073;&#1088;&#1072;&#1078;&#1072;&#1077;&#1090;&#1089;&#1103; &#1085;&#1072; &#1101;&#1082;&#1088;&#1072;&#1085;&#1077; &#1072; &#1090;&#1086; &#1074;&#1088;&#1077;&#1084;&#1103; &#1082;&#1072;&#1082; GPU &#1088;&#1080;&#1089;&#1091;&#1077;&#1090; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077; &#1074; &#1076;&#1088;&#1091;&#1075;&#1086;&#1084;, &#1087;&#1086;&#1089;&#1083;&#1077; &#1095;&#1077;&#1075;&#1086; &#1092;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1099; &#1084;&#1077;&#1085;&#1103;&#1102;&#1090;&#1089;&#1103; &#1084;&#1077;&#1089;&#1090;&#1072;&#1084;&#1080; (swap). &#1069;&#1090;&#1086; &#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103; &#1076;&#1074;&#1086;&#1081;&#1085;&#1072;&#1103; (&#1087;&#1086;&#1090;&#1086;&#1084;&#1091; &#1095;&#1090;&#1086; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; &#1076;&#1074;&#1072;) &#1073;&#1091;&#1092;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;. &#1054;&#1076;&#1085;&#1072;&#1082;&#1086; &#1073;&#1091;&#1092;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103; &#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100; &#1085;&#1077; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1076;&#1074;&#1086;&#1081;&#1085;&#1072;&#1103;, &#1085;&#1086; &#1080; &#1090;&#1088;&#1086;&#1081;&#1085;&#1072;&#1103;, &#1080; &#1095;&#1077;&#1090;&#1074;&#1077;&#1088;&#1085;&#1072;&#1103; &#1080; &#1090;. &#1076;. &#1042; Vulkan &#1074;&#1077;&#1089;&#1100; &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1085;&#1099;&#1081; &#1074;&#1099;&#1096;&#1077; &#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089; &laquo;&#1082;&#1088;&#1091;&#1095;&#1077;&#1085;&#1080;&#1103;&raquo; &#1092;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; &#1085;&#1072; &#1082;&#1072;&#1088;&#1091;&#1089;&#1077;&#1083;&#1080; &laquo;&#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1082;&#1072;-&#1086;&#1090;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077;&raquo; &#1086;&#1073;&#1086;&#1073;&#1097;&#1077;&#1085; &#1074; &#1087;&#1086;&#1085;&#1103;&#1090;&#1080;&#1080; Swapchain.</p>
<h2>Swapchain</h2>
<p>Swapchain &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090; &#1089;&#1086;&#1073;&#1086;&#1081; &#1085;&#1072;&#1073;&#1086;&#1088; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1081; &#1080;&#1083;&#1080;, &#1076;&#1088;&#1091;&#1075;&#1080;&#1084;&#1080; &#1089;&#1083;&#1086;&#1074;&#1072;&#1084;&#1080;, &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; &#1094;&#1074;&#1077;&#1090;&#1072; (color buffers), &#1072; &#1090;&#1072;&#1082;&#1078;&#1077; &#1084;&#1077;&#1090;&#1086;&#1076; (presentation mode), &#1087;&#1088;&#1080; &#1087;&#1086;&#1084;&#1086;&#1097;&#1080; &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1075;&#1086; &#1101;&#1090;&#1080; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &#1082;&#1088;&#1091;&#1090;&#1103;&#1090;&#1089;&#1103; &#1085;&#1072; &laquo;&#1082;&#1072;&#1088;&#1091;&#1089;&#1077;&#1083;&#1080;&raquo;. &#1052;&#1077;&#1090;&#1086;&#1076;&#1086;&#1074; &#1101;&#1090;&#1080;&#1093; &#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090; &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086;, &#1086; &#1085;&#1080;&#1093; &#1093;&#1086;&#1088;&#1086;&#1096;&#1086; &#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1083; &#1074; <a href="https://software.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-2.html">&#1089;&#1074;&#1086;&#1077;&#1081; &#1073;&#1088;&#1086;&#1096;&#1102;&#1088;&#1077;</a> Pavel Lapinski. &#1053;&#1072;&#1080;&#1073;&#1086;&#1083;&#1077;&#1077; &#1087;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1085;&#1099;&#1084;&#1080; &#1103;&#1074;&#1083;&#1103;&#1102;&#1090;&#1089;&#1103; &#1076;&#1074;&#1072; &#1084;&#1077;&#1090;&#1086;&#1076;&#1072;: FIFO &#1080; MAILBOX. &#1055;&#1088;&#1080;&#1095;&#1077;&#1084;, &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; FIFO &#1075;&#1072;&#1088;&#1072;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086; &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074;&#1086; &#1074;&#1089;&#1077;&#1093; &#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;&#1093; Vulkan, &#1085;&#1086; MAILBOX &#1087;&#1088;&#1077;&#1076;&#1087;&#1086;&#1095;&#1090;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1077;&#1077;, &#1077;&#1089;&#1083;&#1080; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1086;&#1085; &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103;. &#1053;&#1072; &#1088;&#1080;&#1089;. 1 &#1087;&#1086;&#1082;&#1072;&#1079;&#1072;&#1085; &#1084;&#1077;&#1090;&#1086;&#1076; FIFO. MAILBOX &#1086;&#1095;&#1077;&#1085;&#1100; &#1087;&#1086;&#1093;&#1086;&#1078;, &#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091; &#1103; &#1085;&#1077; &#1089;&#1090;&#1072;&#1083; &#1077;&#1075;&#1086; &#1088;&#1080;&#1089;&#1086;&#1074;&#1072;&#1090;&#1100;.</p>
<figure id="attachment_1730" aria-describedby="caption-attachment-1730" style="width: 1586px" class="wp-caption alignnone"><img fetchpriority="high" decoding="async" src="/blog/wp-content/uploads/2021/07/Swapchain.jpg" alt="" width="1586" height="1350" class="size-full wp-image-1730"><figcaption id="caption-attachment-1730" class="wp-caption-text">&#1056;&#1080;&#1089;. 1 &mdash; Swapchain, FIFO</figcaption></figure>
<p>&#1058;&#1072;&#1082;&#1080;&#1084; &#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;, &#1087;&#1088;&#1080; &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1080; Swapchain&rsquo;&#1072;, &#1084;&#1099; &#1076;&#1086;&#1083;&#1078;&#1085;&#1099; &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1100; &#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1077;:</p>
<ul>
<li>&#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1081; (&#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1087;&#1080;&#1082;&#1089;&#1077;&#1083;&#1103;)</li>
<li>&#1076;&#1083;&#1080;&#1085;&#1091; &#1080; &#1096;&#1080;&#1088;&#1080;&#1085;&#1091; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103;</li>
<li>&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1081;</li>
<li>&#1084;&#1077;&#1090;&#1086;&#1076; &laquo;&#1082;&#1088;&#1091;&#1095;&#1077;&#1085;&#1080;&#1103; &#1085;&#1072; &#1082;&#1072;&#1088;&#1091;&#1089;&#1077;&#1083;&#1080;&raquo; (presentation mode)</li>
</ul>
<p>&#1042;&#1089;&#1077; &#1101;&#1090;&#1080; &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099; &#1079;&#1072;&#1074;&#1080;&#1089;&#1103;&#1090; &#1086;&#1090; &#1085;&#1072;&#1096;&#1077;&#1081; &#1087;&#1086;&#1074;&#1077;&#1088;&#1093;&#1085;&#1086;&#1089;&#1090;&#1080; (Surface). &#1042;&#1087;&#1088;&#1086;&#1095;&#1077;&#1084;, &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1080;&#1093; &#1076;&#1074;&#1091;&#1093; &#1084;&#1099; &#1074;&#1086;&#1083;&#1100;&#1085;&#1099; &#1074;&#1099;&#1073;&#1080;&#1088;&#1072;&#1090;&#1100; &#1080;&#1079; &#1087;&#1086;&#1090;&#1077;&#1085;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1086; &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1080;&#1093; &#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090;&#1086;&#1074;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1102;&#1090;&#1089;&#1103; &#1087;&#1086;&#1074;&#1077;&#1088;&#1093;&#1085;&#1086;&#1089;&#1090;&#1100;&#1102;.</p>
<div class="codecolorer-container cpp default" style="overflow:auto;white-space:nowrap;"><div class="cpp codecolorer"><span class="co1">// THE FOLLOWING IS PSEUDOCODE!</span><br>
<br>
<span class="co1">// Field</span><br>
vk<span class="sy4">::</span><span class="me2">SwapchainKHR</span> m_Swapchain<span class="sy4">;</span><br>
<br>
<span class="co1">// Constructor</span><br>
m_Swapchain<span class="br0">(</span>CreateSwapchain<span class="br0">(</span>width, height<span class="br0">)</span><span class="br0">)</span><br>
<br>
<span class="co1">// Function</span><br>
vk<span class="sy4">::</span><span class="me2">SwapchainKHR</span> CreateSwapchain<span class="br0">(</span><br>
&nbsp; &nbsp; <span class="kw4">uint32_t</span> width,<br>
&nbsp; &nbsp; <span class="kw4">uint32_t</span> height<span class="br0">)</span><br>
<span class="br0">{</span><br>
&nbsp; &nbsp; <span class="co1">// 1. Choose the best surface format</span><br>
&nbsp; &nbsp; <span class="kw4">auto</span> surfaceFormats <span class="sy1">=</span> m_PhysicalDevice.<span class="me1">getSurfaceFormatsKHR</span><span class="br0">(</span>m_Surface<span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>surfaceFormats.<span class="me1">empty</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">throw</span> VkException<span class="br0">(</span>FUNCTION_INFO<span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">SurfaceFormatKHR</span> surfaceFormat <span class="sy1">=</span> surfaceFormats<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>surfaceFormats.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span> <span class="sy1">==</span> <span class="nu0">1</span> <span class="sy3">&amp;&amp;</span> surfaceFormats<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>.<span class="me1">format</span> <span class="sy1">==</span> vk<span class="sy4">::</span><span class="me2">Format</span><span class="sy4">::</span><span class="me2">eUndefined</span><span class="br0">)</span><br>
&nbsp; &nbsp; <span class="br0">{</span> &nbsp; <span class="co1">// This means that all formats are available</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; surfaceFormat <span class="sy1">=</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Format specifies the bit layout of a color value in memory</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// (eR8G8B8A8Unorm: 32-bit unsigned normalized format that has</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// an 8-bit R component in byte 0, an 8-bit G component in byte 1,</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// an 8-bit B component in byte 2, and an 8-bit A component in byte 3).</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Unsigned normalized format maps [0...255] integer to [0.0 ... 1.0] float.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">Format</span><span class="sy4">::</span><span class="me2">eR8G8B8A8Unorm</span>,<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Color space specifies the mapping between the RGB component values</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// and the human-perceived color (SRGB color space is commonly used in computer displays)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ColorSpaceKHR</span><span class="sy4">::</span><span class="me2">eSrgbNonlinear</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="br0">}</span><br>
&nbsp; &nbsp; <span class="kw1">else</span><br>
&nbsp; &nbsp; <span class="br0">{</span> &nbsp; <span class="co1">// Not all formats are available</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">auto</span> searchFmt <span class="sy1">=</span> std<span class="sy4">::</span><span class="me2">find_if</span><span class="br0">(</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; surfaceFormats.<span class="me1">cbegin</span><span class="br0">(</span><span class="br0">)</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; surfaceFormats.<span class="me1">cend</span><span class="br0">(</span><span class="br0">)</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">[</span><span class="br0">]</span><span class="br0">(</span><span class="kw4">const</span> vk<span class="sy4">::</span><span class="me2">SurfaceFormatKHR</span><span class="sy3">&amp;</span> fmt<span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="br0">(</span>fmt.<span class="me1">format</span> <span class="sy1">==</span> vk<span class="sy4">::</span><span class="me2">Format</span><span class="sy4">::</span><span class="me2">eR8G8B8A8Unorm</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy3">||</span> fmt.<span class="me1">format</span> <span class="sy1">==</span> vk<span class="sy4">::</span><span class="me2">Format</span><span class="sy4">::</span><span class="me2">eB8G8R8A8Unorm</span><span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy3">&amp;&amp;</span> fmt.<span class="me1">colorSpace</span> <span class="sy1">==</span> vk<span class="sy4">::</span><span class="me2">ColorSpaceKHR</span><span class="sy4">::</span><span class="me2">eSrgbNonlinear</span><span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span><span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>searchFmt <span class="sy3">!</span><span class="sy1">=</span> surfaceFormats.<span class="me1">cend</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; surfaceFormat <span class="sy1">=</span> <span class="sy2">*</span>searchFmt<span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="br0">}</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// 2. Choose the best presentation mode</span><br>
&nbsp; &nbsp; <span class="kw4">auto</span> presentModes <span class="sy1">=</span> m_PhysicalDevice.<span class="me1">getSurfacePresentModesKHR</span><span class="br0">(</span>m_Surface<span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>presentModes.<span class="me1">empty</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">throw</span> VkException<span class="br0">(</span>FUNCTION_INFO<span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">PresentModeKHR</span> presentMode <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">PresentModeKHR</span><span class="sy4">::</span><span class="me2">eFifo</span><span class="sy4">;</span> <span class="co1">// FIFO presentation mode (no tearing, possible input lag) is the only one that is guaranteed to be available</span><br>
&nbsp; &nbsp; <span class="kw4">auto</span> searchPmd <span class="sy1">=</span> std<span class="sy4">::</span><span class="me2">find</span><span class="br0">(</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; presentModes.<span class="me1">cbegin</span><span class="br0">(</span><span class="br0">)</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; presentModes.<span class="me1">cend</span><span class="br0">(</span><span class="br0">)</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">PresentModeKHR</span><span class="sy4">::</span><span class="me2">eMailbox</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// Another good option is MAILBOX: no tearing and input lag is minimized. Makes sense only if there are at least 3 images in the swap chain.</span><br>
&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>searchPmd <span class="sy3">!</span><span class="sy1">=</span> presentModes.<span class="me1">cend</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; presentMode <span class="sy1">=</span> <span class="sy2">*</span>searchPmd<span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// Acquired capabilities contain important information about ranges (limits) that</span><br>
&nbsp; &nbsp; <span class="co1">// are supported by the swap chain, that is, minimal and maximal number of images,</span><br>
&nbsp; &nbsp; <span class="co1">// minimal and maximal dimensions of images, or supported transforms (some platforms</span><br>
&nbsp; &nbsp; <span class="co1">// may require transformations applied to images before these images may be presented).</span><br>
&nbsp; &nbsp; <span class="co1">// https://software.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-2.html</span><br>
&nbsp; &nbsp; <span class="kw4">auto</span> surfaceCapabilities <span class="sy1">=</span> m_PhysicalDevice.<span class="me1">getSurfaceCapabilitiesKHR</span><span class="br0">(</span>m_Surface<span class="br0">)</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// 3. Choose the best swap chain image resolution</span><br>
&nbsp; &nbsp; <span class="co1">// If currentExtent.(width|height) == uint32_t::max this means that window</span><br>
&nbsp; &nbsp; <span class="co1">// subsystem allows us to set any width and height for our swapchain within</span><br>
&nbsp; &nbsp; <span class="co1">// [minImageExtent...maxImageExtent] boundaries</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">Extent2D</span> swapExtent <span class="sy1">=</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; surfaceCapabilities.<span class="me1">currentExtent</span>.<span class="me1">width</span> <span class="sy3">!</span><span class="sy1">=</span> <span class="br0">(</span>std<span class="sy4">::</span><span class="me2">numeric_limits</span><span class="sy1">&lt;</span><span class="kw4">uint32_t</span><span class="sy1">&gt;</span><span class="sy4">::</span><span class="me2">max</span><span class="br0">)</span><span class="br0">(</span><span class="br0">)</span> <span class="sy4">?</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; surfaceCapabilities.<span class="me1">currentExtent</span> <span class="sy4">:</span> vk<span class="sy4">::</span><span class="me2">Extent2D</span><span class="br0">{</span> width, height <span class="br0">}</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="co1">// Surface defines max and min size, so make sure within boundaries by clamping value</span><br>
&nbsp; &nbsp; swapExtent.<span class="me1">width</span> <span class="sy1">=</span> util<span class="sy4">::</span><span class="me2">constraint</span><span class="br0">(</span>swapExtent.<span class="me1">width</span>, surfaceCapabilities.<span class="me1">minImageExtent</span>.<span class="me1">width</span>, surfaceCapabilities.<span class="me1">maxImageExtent</span>.<span class="me1">width</span><span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; swapExtent.<span class="me1">height</span> <span class="sy1">=</span> util<span class="sy4">::</span><span class="me2">constraint</span><span class="br0">(</span>swapExtent.<span class="me1">width</span>, surfaceCapabilities.<span class="me1">minImageExtent</span>.<span class="me1">height</span>, surfaceCapabilities.<span class="me1">maxImageExtent</span>.<span class="me1">height</span><span class="br0">)</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// 4. Create swap chain createinfo</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">SwapchainCreateInfoKHR</span> createInfo<br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">surface</span> <span class="sy1">=</span> m_Surface,<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// An application may request more images. If it wants to use multiple images at</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// once it may do so, for example, when encoding a video stream where every fourth</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// image is a key frame and the application needs it to prepare the remaining three</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// frames. Such usage will determine the number of images that will be automatically</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// created in a swap chain: how many images the application requires at once for</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// processing and how many images the presentation engine requires to function properly.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// https://software.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-2.html</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">minImageCount</span> <span class="sy1">=</span> surfaceCapabilities.<span class="me1">maxImageCount</span> <span class="sy1">&gt;</span> <span class="nu0">0</span> <span class="sy4">?</span> <span class="co1">// maxImageCount = 0 means that there's no maximum</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">(</span>std<span class="sy4">::</span><span class="me2">min</span><span class="br0">)</span><span class="br0">(</span>surfaceCapabilities.<span class="me1">minImageCount</span> <span class="sy2">+</span> <span class="nu0">1</span>, surfaceCapabilities.<span class="me1">maxImageCount</span><span class="br0">)</span> <span class="sy4">:</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; surfaceCapabilities.<span class="me1">minImageCount</span> <span class="sy2">+</span> <span class="nu0">1</span>,<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">imageFormat</span> <span class="sy1">=</span> surfaceFormat.<span class="me1">format</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">imageColorSpace</span> <span class="sy1">=</span> surfaceFormat.<span class="me1">colorSpace</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">imageExtent</span> <span class="sy1">=</span> swapExtent,<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">imageArrayLayers</span> <span class="sy1">=</span> <span class="nu0">1</span>, <span class="co1">// specifies the amount of layers each image consists of. This is always 1 unless you are developing a stereoscopic 3D application.</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Usage flags define how a given image may be used in Vulkan. If we want an image to be</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// sampled (used inside shaders) it must be created with &quot;sampled&quot; usage. If the image</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// should be used as a depth render target, it must be created with &quot;depth and stencil&quot; usage.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// An image without proper usage &quot;enabled&quot; cannot be used for a given purpose or the results</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// of such operations will be undefined.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// For a swap chain we want to render(in most cases) into the image(use it as a render target),</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// so we must specify &ldquo;color attachment&rdquo; usage with VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT enum.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// In Vulkan this usage is always available for swap chains, so we can always set it without</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// any additional checking. But for any other usage we must ensure it is supported &ndash; we can do</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// this through a &quot;supportedUsageFlags&quot; member of surface capabilities structure.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// https://software.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-2.html</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">imageUsage</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ImageUsageFlagBits</span><span class="sy4">::</span><span class="me2">eColorAttachment</span> <span class="sy3">|</span> vk<span class="sy4">::</span><span class="me2">ImageUsageFlagBits</span><span class="sy4">::</span><span class="me2">eTransferDst</span>, <span class="co1">// just color, no depth; &quot;transfer destination&quot; usage is required for image clear operation</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">preTransform</span> <span class="sy1">=</span> surfaceCapabilities.<span class="me1">currentTransform</span>, <span class="co1">// we can specify that a certain transform should be applied to images in the swap chain if it is supported</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">compositeAlpha</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">CompositeAlphaFlagBitsKHR</span><span class="sy4">::</span><span class="me2">eOpaque</span>, <span class="co1">// no alpha blending (specifies if the alpha channel should be used for blending with other windows in the window system)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">presentMode</span> <span class="sy1">=</span> presentMode,<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">clipped</span> <span class="sy1">=</span> VK_TRUE <span class="co1">// If set to VK_TRUE then that means that we don't care about the color of pixels that are obscured, for example because another window is in front of them.</span><br>
&nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// 5. If graphics and presentation families are different, then swapchain must let images be shared between queue families</span><br>
&nbsp; &nbsp; <span class="kw4">uint32_t</span> queuFamilyIndices<span class="br0">[</span><span class="br0">]</span><br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; m_GraphicsQueueFamilyIndex,<br>
&nbsp; &nbsp; &nbsp; &nbsp; m_PresentationQueueFamilyIndex<br>
&nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>m_GraphicsQueueFamilyIndex <span class="sy3">!</span><span class="sy1">=</span> m_PresentationQueueFamilyIndex<span class="br0">)</span><br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// If we want to reference images from many different queue families at a time we can do so.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// In this case we must provide &quot;concurrent&quot; sharing mode. But this (probably) requires us to</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// manage image data coherency by ourselves, that is, we must synchronize different queues in</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// such a way that data in the images is proper and no hazards occur - some queues are reading</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// data from images, but other queues haven't finished writing to them yet.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// We may not specify these queue families and just tell Vulkan that only one queue family</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// (queues from one family) will be referencing image at a time. This doesn't mean other queues</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// can't reference these images. It just means they can't do it all at once, at the same time.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// So if we want to reference images from one family and then from another we must specifically</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// tell Vulkan: &quot;My image was used inside this queue family, but from now on another family,</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// this one, will be referencing it.&quot; Such a transition is done using image memory barrier.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// https://software.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-2.html</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Images can be used across multiple queue families without explicit ownership transfers.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; createInfo.<span class="me1">imageSharingMode</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">SharingMode</span><span class="sy4">::</span><span class="me2">eConcurrent</span><span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Concurrent mode requires you to specify in advance between which queue families ownership will be shared.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; createInfo.<span class="me1">queueFamilyIndexCount</span> <span class="sy1">=</span> <span class="kw3">sizeof</span><span class="br0">(</span>queuFamilyIndices<span class="br0">)</span> <span class="sy2">/</span> <span class="kw3">sizeof</span><span class="br0">(</span>queuFamilyIndices<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; createInfo.<span class="me1">pQueueFamilyIndices</span> <span class="sy1">=</span> queuFamilyIndices<span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="br0">}</span><br>
&nbsp; &nbsp; <span class="kw1">else</span><br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// An image is owned by one queue family at a time and ownership must be explicitly transferred</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// before using it in another queue family. This option offers the best performance.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; createInfo.<span class="me1">imageSharingMode</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">SharingMode</span><span class="sy4">::</span><span class="me2">eExclusive</span><span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; createInfo.<span class="me1">queueFamilyIndexCount</span> <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; createInfo.<span class="me1">pQueueFamilyIndices</span> <span class="sy1">=</span> <span class="kw2">nullptr</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="br0">}</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// 6. With Vulkan it's possible that your swap chain becomes invalid or unoptimized while your application</span><br>
&nbsp; &nbsp; <span class="co1">// is running, for example because the window was resized. In that case the swap chain actually needs to be</span><br>
&nbsp; &nbsp; <span class="co1">// recreated from scratch and a reference to the old one must be specified in this field.</span><br>
&nbsp; &nbsp; createInfo.<span class="me1">oldSwapchain</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">SwapchainKHR</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// default vk::SwapchainKHR() plays a role of nullptr</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// 7. Create swapchain</span><br>
&nbsp; &nbsp; m_SwapChainImageFormat <span class="sy1">=</span> createInfo.<span class="me1">imageFormat</span><span class="sy4">;</span><br>
&nbsp; &nbsp; m_SwapChainExtent <span class="sy1">=</span> swapExtent<span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> m_LogicalDevice.<span class="me1">createSwapchainKHR</span><span class="br0">(</span>createInfo<span class="br0">)</span><span class="sy4">;</span><br>
<span class="br0">}</span><br>
<br>
<span class="co1">// Destructor</span><br>
m_LogicalDevice.<span class="me1">destroySwapchainKHR</span><span class="br0">(</span>m_Swapchain<span class="br0">)</span><span class="sy4">;</span></div></div>
<p>&#1043;&#1076;&#1077; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; Swapchain. &#1042;&#1086;-&#1087;&#1077;&#1088;&#1074;&#1099;&#1093;, &#1086;&#1085; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103; &#1087;&#1088;&#1080; &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1080; &#1090;. &#1085;. ImageViews, &#1086; &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093; &#1088;&#1077;&#1095;&#1100; &#1087;&#1086;&#1081;&#1076;&#1077;&#1090; &#1076;&#1072;&#1083;&#1077;&#1077;. &#1042;&#1086;-&#1074;&#1090;&#1086;&#1088;&#1099;&#1093; &#1080; &#1074; &#1075;&#1083;&#1072;&#1074;&#1085;&#1099;&#1093;, Swapchain &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103; &#1074; &#1084;&#1077;&#1090;&#1086;&#1076;&#1077; &#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1082;&#1080; &mdash; &#1074; &#1076;&#1074;&#1091;&#1093; &#1084;&#1077;&#1089;&#1090;&#1072;&#1093; (&#1089;&#1084;. &#1088;&#1080;&#1089;. 1): Acquire Image &mdash; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077;, &#1076;&#1072;&#1073;&#1099; &#1085;&#1072;&#1088;&#1080;&#1089;&#1086;&#1074;&#1072;&#1090;&#1100; &#1074; &#1085;&#1077;&#1084; &#1095;&#1090;&#1086;-&#1090;&#1086; &#1080; Present Image &mdash; &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1090;&#1100; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077; &#1076;&#1083;&#1103; &#1086;&#1090;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &#1085;&#1072; &#1101;&#1082;&#1088;&#1072;&#1085;&#1077;.</p>
<h2>Swapchain Images &amp; ImageViews</h2>
<p>&#1044;&#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1095;&#1085;&#1086; &#1074;&#1085;&#1103;&#1090;&#1085;&#1086;&#1077; &#1086;&#1073;&#1098;&#1103;&#1089;&#1085;&#1077;&#1085;&#1080;&#1077; &#1090;&#1086;&#1075;&#1086;, &#1095;&#1090;&#1086; &#1090;&#1072;&#1082;&#1086;&#1077; ImageView, &#1087;&#1088;&#1080;&#1074;&#1077;&#1076;&#1077;&#1085;&#1086; &#1074; <a href="https://vkguide.dev/docs/chapter-5/vulkan_images/">Vulkan Guide</a>. &#1058;&#1072;&#1084; &#1089;&#1082;&#1072;&#1079;&#1072;&#1085;&#1086; &#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1077;:</p>
<blockquote><p>
&#1048;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &mdash; &#1101;&#1090;&#1086; &#1077;&#1097;&#1077; &#1086;&#1076;&#1080;&#1085; &#1090;&#1080;&#1087; &laquo;&#1093;&#1088;&#1072;&#1085;&#1080;&#1083;&#1080;&#1097;&#1072;&raquo;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1077;&#1089;&#1090;&#1100; &#1074; Vulkan, &#1087;&#1086;&#1084;&#1080;&#1084;&#1086; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;. &#1042; &#1086;&#1090;&#1083;&#1080;&#1095;&#1080;&#1077; &#1086;&#1090; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;, &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &#1089;&#1083;&#1086;&#1078;&#1085;&#1077;&#1077; &#1080;&#1079;-&#1079;&#1072; &#1074;&#1089;&#1077;&#1081; &#1083;&#1086;&#1075;&#1080;&#1082;&#1080;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1081; &#1086;&#1085;&#1080; &#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1090;, &#1080; &#1080;&#1093; &#1085;&#1072;&#1089;&#1090;&#1088;&#1086;&#1077;&#1082;. VkImage &mdash; &#1101;&#1090;&#1086; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090; &#1092;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1077; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103;. &#1054;&#1085; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090; &#1087;&#1080;&#1082;&#1089;&#1077;&#1083;&#1080; &#1080; &#1086;&#1089;&#1085;&#1086;&#1074;&#1085;&#1091;&#1102; &#1087;&#1072;&#1084;&#1103;&#1090;&#1100; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103;, &#1085;&#1086; &#1085;&#1077; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090; &#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1080; &#1086; &#1090;&#1086;&#1084;, &#1082;&#1072;&#1082; &#1077;&#1077; &#1095;&#1080;&#1090;&#1072;&#1090;&#1100;. VkImageView &mdash; &#1101;&#1090;&#1086; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;-&#1086;&#1073;&#1105;&#1088;&#1090;&#1082;&#1072; &#1074;&#1086;&#1082;&#1088;&#1091;&#1075; VkImage. &#1054;&#1085; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090; &#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1102; &#1086; &#1090;&#1086;&#1084;, &#1082;&#1072;&#1082; &#1080;&#1085;&#1090;&#1077;&#1088;&#1087;&#1088;&#1077;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103;, &#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1077;&#1089;&#1083;&#1080; &#1074;&#1099; &#1093;&#1086;&#1090;&#1080;&#1090;&#1077; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1082; &#1091;&#1095;&#1072;&#1089;&#1090;&#1082;&#1091; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &#1080;&#1083;&#1080; &#1089;&#1083;&#1086;&#1102; (&#1077;&#1089;&#1083;&#1080; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077; 3-&#1093;&#1084;&#1077;&#1088;&#1085;&#1086;&#1077;), &#1080;&#1083;&#1080; &#1077;&#1089;&#1083;&#1080; &#1074;&#1099; &#1093;&#1086;&#1090;&#1080;&#1090;&#1077; &#1087;&#1077;&#1088;&#1077;&#1090;&#1072;&#1089;&#1086;&#1074;&#1072;&#1090;&#1100; &#1094;&#1074;&#1077;&#1090;&#1086;&#1074;&#1099;&#1077; &#1082;&#1072;&#1085;&#1072;&#1083;&#1099; &#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1099;&#1084; &#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;.
</p></blockquote>
<p>&#1040; &#1085;&#1072; <a href="https://www.reddit.com/r/vulkan/comments/b2bv76/what_is_an_imageview/">&#1092;&#1086;&#1088;&#1091;&#1084;&#1077; reddit</a> &#1089;&#1088;&#1072;&#1074;&#1085;&#1080;&#1074;&#1072;&#1102;&#1090; ImageView &#1089; &#1090;&#1080;&#1087;&#1086;&#1084; string_view &#1080;&#1079; &#1089;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;&#1085;&#1086;&#1081; &#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082;&#1080; &#1103;&#1079;&#1099;&#1082;&#1072; C++ (&#1087;&#1088;&#1086; string_view &#1084;&#1086;&#1078;&#1085;&#1086; &#1087;&#1086;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100; &#1090;&#1091;&#1090; <a href="https://www.foonathan.net/2017/03/string_view-temporary/">&#1090;&#1091;&#1090;</a>).</p>
<div class="codecolorer-container cpp default" style="overflow:auto;white-space:nowrap;"><div class="cpp codecolorer"><span class="co1">// THE FOLLOWING IS PSEUDOCODE!</span><br>
<br>
<span class="co1">// Field</span><br>
std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>vk<span class="sy4">::</span><span class="me2">ImageView</span><span class="sy1">&gt;</span> m_SwapchainImages<span class="sy4">;</span><br>
<br>
<span class="co1">// Constructor</span><br>
m_SwapchainImages<span class="br0">(</span>CreateImageViews<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><br>
<br>
<span class="co1">// Functions</span><br>
std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>vk<span class="sy4">::</span><span class="me2">ImageView</span><span class="sy1">&gt;</span> CreateImageViews<span class="br0">(</span><span class="br0">)</span><br>
<span class="br0">{</span><br>
&nbsp; &nbsp; std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>vk<span class="sy4">::</span><span class="me2">ImageView</span><span class="sy1">&gt;</span> imageViews<span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">auto</span> image <span class="sy4">:</span> m_LogicalDevice.<span class="me1">getSwapchainImagesKHR</span><span class="br0">(</span>m_Swapchain<span class="br0">)</span><span class="br0">)</span><br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; imageViews.<span class="me1">push_back</span><span class="br0">(</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateImageView<span class="br0">(</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_LogicalDevice,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; image,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_SwapChainImageFormat,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageAspectFlagBits</span><span class="sy4">::</span><span class="me2">eColor</span><span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span><span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="br0">}</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> imageViews<span class="sy4">;</span><br>
<span class="br0">}</span><br>
<br>
vk<span class="sy4">::</span><span class="me2">ImageView</span> CreateImageView<span class="br0">(</span><br>
&nbsp; &nbsp; <span class="kw4">const</span> vk<span class="sy4">::</span><span class="me2">Device</span><span class="sy3">&amp;</span> logicalDevice,<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">Image</span> image,<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">Format</span> format,<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageAspectFlags</span> aspectFlags<span class="br0">)</span><br>
<span class="br0">{</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageViewCreateInfo</span> viewCreateInfo<br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">image</span> <span class="sy1">=</span> image,<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">viewType</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ImageViewType</span><span class="sy4">::</span><span class="me2">e2D</span>, <span class="co1">// Type of image (1D, 2D, 3D, Cube map, etc)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">format</span> <span class="sy1">=</span> format,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// The components field allows remapping of rgba components to other rgba values the</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// color channels around. For example, you can map all of the channels to the red channel</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// for a monochrome texture. You can also map constant values of 0 and 1 to a channel.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">components</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ComponentMapping</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">r</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ComponentSwizzle</span><span class="sy4">::</span><span class="me2">eIdentity</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">g</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ComponentSwizzle</span><span class="sy4">::</span><span class="me2">eIdentity</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">b</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ComponentSwizzle</span><span class="sy4">::</span><span class="me2">eIdentity</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">a</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ComponentSwizzle</span><span class="sy4">::</span><span class="me2">eIdentity</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// The subresourceRange field describes what the image's purpose is and which part of the image should be accessed.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">subresourceRange</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ImageSubresourceRange</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">aspectMask</span> <span class="sy1">=</span> aspectFlags, <span class="co1">// Which aspect of image to view (e.g. COLOR_BIT for viewing color)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">baseMipLevel</span> <span class="sy1">=</span> <span class="nu0">0</span>, &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Start mipmap level to view from</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">levelCount</span> <span class="sy1">=</span> <span class="nu0">1</span>, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Number of mipmap levels to view</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// For cube and cube array image views, the layers of the image view starting</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// at baseArrayLayer correspond to faces in the order +X, -X, +Y, -Y, +Z, -Z.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">baseArrayLayer</span> <span class="sy1">=</span> <span class="nu0">0</span>, &nbsp; &nbsp; &nbsp; <span class="co1">// Start array layer to view from</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">layerCount</span> <span class="sy1">=</span> <span class="nu0">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="co1">// Number of array levels to view</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span><br>
&nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> logicalDevice.<span class="me1">createImageView</span><span class="br0">(</span>viewCreateInfo<span class="br0">)</span><span class="sy4">;</span><br>
<span class="br0">}</span><br>
<br>
<span class="co1">// Destructor</span><br>
<span class="kw1">for</span> <span class="br0">(</span><span class="kw4">auto</span><span class="sy3">&amp;</span> imageView <span class="sy4">:</span> m_SwapchainImages<span class="br0">)</span><br>
&nbsp; &nbsp; m_LogicalDevice.<span class="me1">destroyImageView</span><span class="br0">(</span>imageView<span class="br0">)</span><span class="sy4">;</span></div></div>
<p>&#1050;&#1090;&#1086; &#1089;&#1089;&#1099;&#1083;&#1072;&#1077;&#1090;&#1089;&#1103; &#1085;&#1072; SwapchainImages. &#1058;&#1086;&#1083;&#1100;&#1082;&#1086; &#1092;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1099; (Framebuffers) &mdash; &#1089;&#1084;. &#1076;&#1072;&#1083;&#1077;&#1077;.</p>
<h2>Depth Buffer (&#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;)</h2>
<p>&#1052;&#1099; &#1089;&#1086;&#1079;&#1076;&#1072;&#1083;&#1080; Swapchain &#1089; &#1077;&#1075;&#1086; &#1085;&#1072;&#1073;&#1086;&#1088;&#1086;&#1084; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; &#1094;&#1074;&#1077;&#1090;&#1072;, &#1085;&#1086; &#1076;&#1083;&#1103; &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1103; &#1090;&#1088;&#1077;&#1093;&#1084;&#1077;&#1088;&#1085;&#1086;&#1081; &#1088;&#1077;&#1072;&#1083;&#1100;&#1085;&#1086;&#1089;&#1090;&#1080; &#1085;&#1072;&#1084; &#1087;&#1086;&#1085;&#1072;&#1076;&#1086;&#1073;&#1080;&#1090;&#1089;&#1103; &#1082;&#1072;&#1082; &#1084;&#1080;&#1085;&#1080;&#1084;&#1091;&#1084; &#1077;&#1097;&#1077; &#1086;&#1076;&#1080;&#1085; &#1074;&#1080;&#1076; &#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &mdash; &#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;. &#1042;&#1086;&#1086;&#1073;&#1097;&#1077;, &#1076;&#1083;&#1103; &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103; &#1095;&#1077;&#1075;&#1086;-&#1083;&#1080;&#1073;&#1086; &#1076;&#1074;&#1091;&#1084;&#1077;&#1088;&#1085;&#1086;&#1075;&#1086;, &#1073;&#1091;&#1076;&#1100; &#1090;&#1086; &#1073;&#1091;&#1092;&#1077;&#1088; &#1094;&#1074;&#1077;&#1090;&#1072;, &#1090;&#1077;&#1082;&#1089;&#1090;&#1091;&#1088;&#1072; &#1080;&#1083;&#1080; &#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099; &mdash; &#1074; Vulkan &#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090; &#1090;&#1080;&#1087; VkImage (&#1072; &#1076;&#1083;&#1103; &#1089;&#1089;&#1099;&#1083;&#1082;&#1080; &#1085;&#1072; VkImage, &#1082;&#1072;&#1082; &#1084;&#1099; &#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083;&#1080; &#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090; &#1090;&#1080;&#1087; VkImageView). &#1057;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &#1088;&#1072;&#1089;&#1087;&#1072;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103; &#1085;&#1072; &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086; &#1101;&#1090;&#1072;&#1087;&#1086;&#1074;:</p>
<ol>
<li>&#1057;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072; VkImage, &#1080;&#1084;&#1077;&#1102;&#1097;&#1077;&#1075;&#1086; &#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1099;&#1081; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090;</li>
<li>&#1042;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1103; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1076;&#1083;&#1103; &#1093;&#1088;&#1072;&#1085;&#1077;&#1085;&#1080;&#1103; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103;</li>
<li>&#1057;&#1074;&#1103;&#1079;&#1099;&#1074;&#1072;&#1085;&#1080;&#1077; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072; VkImage &#1089; &#1074;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1086;&#1081; &#1087;&#1072;&#1084;&#1103;&#1090;&#1100;&#1102;</li>
<li>&#1057;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072; VkImageView</li>
</ol>
<p>&#1069;&#1090;&#1080; &#1074;&#1077;&#1097;&#1080; &#1103; &#1088;&#1077;&#1096;&#1080;&#1083; &#1087;&#1086;&#1084;&#1077;&#1089;&#1090;&#1080;&#1090;&#1100; &#1074; &#1086;&#1090;&#1076;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081; &#1082;&#1083;&#1072;&#1089;&#1089;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1085;&#1072;&#1079;&#1074;&#1072;&#1083; VkImage2d:</p>
<div class="codecolorer-container cpp default" style="overflow:auto;white-space:nowrap;"><div class="cpp codecolorer"><span class="kw2">class</span> VkImage2d<br>
<span class="br0">{</span><br>
<span class="kw2">private</span><span class="sy4">:</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">Image</span> m_Image<span class="sy4">;</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">DeviceMemory</span> m_ImageMemory<span class="sy4">;</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageView</span> m_ImageView<span class="sy4">;</span><br>
<br>
<span class="kw2">public</span><span class="sy4">:</span><br>
&nbsp; &nbsp; VkImage2d<span class="br0">(</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">uint32_t</span> width,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">uint32_t</span> height,<br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">Format</span> format,<br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageTiling</span> tiling,<br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageUsageFlags</span> useFlags,<br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">MemoryPropertyFlags</span> memoryPropFlags,<br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageAspectFlags</span> aspectFlags<span class="br0">)</span><br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// CREATE IMAGE STRUCTRE</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; m_Image <span class="sy1">=</span> logicalDevice.<span class="me1">createImage</span><span class="br0">(</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageCreateInfo</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">format</span> <span class="sy1">=</span> format,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">extent</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">Extent3D</span> <span class="br0">{</span>width, height, 1u<span class="br0">}</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">tiling</span> <span class="sy1">=</span> tiling, <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">usage</span> <span class="sy1">=</span> useFlags,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span><span class="br0">)</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// ALLOCATE MEMORY</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; m_ImageMemory <span class="sy1">=</span> logicalDevice.<span class="me1">allocateMemory</span><span class="br0">(</span>...<span class="br0">)</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// BIND IMAGE AND MEMORY</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; logicalDevice.<span class="me1">bindImageMemory</span><span class="br0">(</span>m_Image, m_ImageMemory, ...<span class="br0">)</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// CREATE IMAGE VIEW</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; m_ImageView <span class="sy1">=</span> CreateImageView<span class="br0">(</span>..., m_Image, format, aspectFlags<span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="br0">}</span><br>
<br>
&nbsp; &nbsp; ~VkImage2d<span class="br0">(</span><span class="br0">)</span><br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; logicalDevice.<span class="me1">destroyImageView</span><span class="br0">(</span>m_ImageView<span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; logicalDevice.<span class="me1">destroyImage</span><span class="br0">(</span>m_Image<span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; logicalDevice.<span class="me1">freeMemory</span><span class="br0">(</span>m_ImageMemory<span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="br0">}</span><br>
<span class="br0">}</span></div></div>
<h3>&#1060;&#1086;&#1088;&#1084;&#1072;&#1090;&#1099; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1081;</h3>
<p>&#1048;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077; &#1076;&#1086;&#1083;&#1078;&#1085;&#1086; &#1080;&#1084;&#1077;&#1090;&#1100; &#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1099;&#1081; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1087;&#1080;&#1082;&#1089;&#1077;&#1083;&#1103;. &#1063;&#1072;&#1089;&#1090;&#1086; &#1076;&#1083;&#1103; &#1088;&#1072;&#1079;&#1085;&#1099;&#1093; &#1089;&#1094;&#1077;&#1085;&#1072;&#1088;&#1080;&#1077;&#1074; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1091;&#1102;&#1090; &#1088;&#1072;&#1079;&#1085;&#1099;&#1077; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1099;: &#1089;&#1082;&#1072;&#1078;&#1077;&#1084;, &#1086;&#1076;&#1080;&#1085; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1087;&#1088;&#1077;&#1076;&#1085;&#1072;&#1079;&#1085;&#1072;&#1095;&#1072;&#1077;&#1090;&#1089;&#1103; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1076;&#1083;&#1103; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103;, &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1084;&#1086;&#1075;&#1086; &#1076;&#1083;&#1103; &#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &#1094;&#1074;&#1077;&#1090;&#1072;, &#1072; &#1076;&#1088;&#1091;&#1075;&#1086;&#1081; &mdash; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1076;&#1083;&#1103; &#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;. &#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088; &#1074; &#1084;&#1086;&#1077;&#1084; &#1087;&#1088;&#1086;&#1077;&#1082;&#1090;&#1077; &#1091;&#1087;&#1086;&#1084;&#1080;&#1085;&#1072;&#1102;&#1090;&#1089;&#1103; &#1087;&#1086; &#1082;&#1088;&#1072;&#1081;&#1085;&#1077;&#1081; &#1084;&#1077;&#1088;&#1077; &#1095;&#1077;&#1090;&#1099;&#1088;&#1077; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1072; &#1087;&#1080;&#1082;&#1089;&#1077;&#1083;&#1103;:</p>
<table>
<tr>
<td style="text-align:left">eR8G8B8A8Unorm</td>
<td style="text-align:left">A four-component, 32-bit unsigned normalized format that has an 8-bit R component in byte 0, an 8-bit G component in byte 1, an 8-bit B component in byte 2, and an 8-bit A component in byte 3</td>
</tr>
<tr>
<td style="text-align:left">eD32Sfloat</td>
<td style="text-align:left">A one-component, 32-bit signed floating-point format that has 32 bits in the depth component</td>
</tr>
<tr>
<td style="text-align:left">eD32SfloatS8Uint</td>
<td style="text-align:left">A two-component format that has 32 signed float bits in the depth component and 8 unsigned integer bits in the stencil component. There are optionally 24 bits that are unused</td>
</tr>
<tr>
<td style="text-align:left">eD24UnormS8Uint</td>
<td style="text-align:left">A two-component, 32-bit packed format that has 8 unsigned integer bits in the stencil component, and 24 unsigned normalized bits in the depth component</td>
</tr>
</table>
<p>&#1055;&#1086;&#1084;&#1080;&#1084;&#1086; &#1090;&#1086;&#1075;&#1086;, &#1095;&#1090;&#1086; &#1085;&#1077; &#1082;&#1072;&#1078;&#1076;&#1099;&#1081; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1075;&#1086;&#1076;&#1080;&#1090;&#1089;&#1103; &#1076;&#1083;&#1103; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103; &#1074; &#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1086;&#1084; &#1073;&#1091;&#1092;&#1077;&#1088;&#1077; (&#1094;&#1074;&#1077;&#1090;&#1072;, &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099; &#1080; &#1087;&#1088;.), &#1085;&#1077; &#1082;&#1072;&#1078;&#1076;&#1099;&#1081; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103; &#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1084; &#1087;&#1088;&#1080;&#1073;&#1086;&#1088;&#1086;&#1084; (GPU). &#1058;&#1072;&#1082;&#1080;&#1084; &#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;, &#1087;&#1088;&#1080; &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1080; &#1073;&#1091;&#1092;&#1077;&#1088;&#1072; (&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;) &#1084;&#1099; &#1076;&#1086;&#1083;&#1078;&#1085;&#1099; &#1074;&#1099;&#1073;&#1088;&#1072;&#1090;&#1100; &#1072;&#1076;&#1077;&#1082;&#1074;&#1072;&#1090;&#1085;&#1099;&#1081; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1087;&#1080;&#1082;&#1089;&#1077;&#1083;&#1103; &#1080;&#1079; &#1088;&#1103;&#1076;&#1072; &#1087;&#1086;&#1090;&#1077;&#1085;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093; &#1082;&#1072;&#1085;&#1076;&#1080;&#1076;&#1072;&#1090;&#1086;&#1074;. &#1055;&#1086;&#1080;&#1089;&#1082; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1072; &#1084;&#1086;&#1078;&#1085;&#1086; &#1079;&#1072;&#1087;&#1080;&#1089;&#1072;&#1090;&#1100; &#1074; &#1074;&#1080;&#1076;&#1077; &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1080;&#1093; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081;:</p>
<div class="codecolorer-container cpp default" style="overflow:auto;white-space:nowrap;"><div class="cpp codecolorer"><span class="co1">// Looks among specified candidates for am image format</span><br>
<span class="co1">// that supports specified tiling and usage.</span><br>
vk<span class="sy4">::</span><span class="me2">Format</span> FindSupportedFormat<span class="br0">(</span><br>
&nbsp; &nbsp; <span class="kw4">const</span> vk<span class="sy4">::</span><span class="me2">PhysicalDevice</span><span class="sy3">&amp;</span> physicalDevice,<br>
&nbsp; &nbsp; <span class="kw4">const</span> std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>vk<span class="sy4">::</span><span class="me2">Format</span><span class="sy1">&gt;</span><span class="sy3">&amp;</span> candidates,<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageTiling</span> tiling,<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">FormatFeatureFlags</span> features<span class="br0">)</span><br>
<span class="br0">{</span><br>
&nbsp; &nbsp; <span class="kw1">for</span> <span class="br0">(</span>vk<span class="sy4">::</span><span class="me2">Format</span> format <span class="sy4">:</span> candidates<span class="br0">)</span><br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">auto</span> props <span class="sy1">=</span> physicalDevice.<span class="me1">getFormatProperties</span><span class="br0">(</span>format<span class="br0">)</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">switch</span> <span class="br0">(</span>tiling<span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">case</span> vk<span class="sy4">::</span><span class="me2">ImageTiling</span><span class="sy4">::</span><span class="me2">eOptimal</span><span class="sy4">:</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span><span class="br0">(</span>props.<span class="me1">optimalTilingFeatures</span> <span class="sy3">&amp;</span> features<span class="br0">)</span> <span class="sy1">==</span> features<span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> format<span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">break</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">case</span> vk<span class="sy4">::</span><span class="me2">ImageTiling</span><span class="sy4">::</span><span class="me2">eLinear</span><span class="sy4">:</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span><span class="br0">(</span>props.<span class="me1">linearTilingFeatures</span> <span class="sy3">&amp;</span> features<span class="br0">)</span> <span class="sy1">==</span> features<span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> format<span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">break</span><span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span><br>
&nbsp; &nbsp; <span class="br0">}</span><br>
&nbsp; &nbsp; <span class="kw1">throw</span> VkException<span class="br0">(</span>FUNCTION_INFO<span class="br0">)</span><span class="sy4">;</span><br>
<span class="br0">}</span><br>
<br>
vk<span class="sy4">::</span><span class="me2">Format</span> FindDepthFormat<span class="br0">(</span><br>
&nbsp; &nbsp; <span class="kw4">const</span> vk<span class="sy4">::</span><span class="me2">PhysicalDevice</span><span class="sy3">&amp;</span> physicalDevice<span class="br0">)</span><br>
<span class="br0">{</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> FindSupportedFormat<span class="br0">(</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; physicalDevice,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span> vk<span class="sy4">::</span><span class="me2">Format</span><span class="sy4">::</span><span class="me2">eD32Sfloat</span>, vk<span class="sy4">::</span><span class="me2">Format</span><span class="sy4">::</span><span class="me2">eD32SfloatS8Uint</span>, vk<span class="sy4">::</span><span class="me2">Format</span><span class="sy4">::</span><span class="me2">eD24UnormS8Uint</span> <span class="br0">}</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageTiling</span><span class="sy4">::</span><span class="me2">eOptimal</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">FormatFeatureFlagBits</span><span class="sy4">::</span><span class="me2">eDepthStencilAttachment</span><span class="br0">)</span><span class="sy4">;</span><br>
<span class="br0">}</span><br>
<br>
vk<span class="sy4">::</span><span class="me2">Format</span> FindColorBufferFormat<span class="br0">(</span><br>
&nbsp; &nbsp; <span class="kw4">const</span> vk<span class="sy4">::</span><span class="me2">PhysicalDevice</span><span class="sy3">&amp;</span> physicalDevice<span class="br0">)</span><br>
<span class="br0">{</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> FindSupportedFormat<span class="br0">(</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; physicalDevice,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span> vk<span class="sy4">::</span><span class="me2">Format</span><span class="sy4">::</span><span class="me2">eR8G8B8A8Unorm</span> <span class="br0">}</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageTiling</span><span class="sy4">::</span><span class="me2">eOptimal</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">FormatFeatureFlagBits</span><span class="sy4">::</span><span class="me2">eColorAttachment</span><span class="br0">)</span><span class="sy4">;</span><br>
<span class="br0">}</span></div></div>
<h3>&#1042;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1077; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;</h3>
<p>&#1042;&#1086;&#1087;&#1088;&#1086;&#1089; &#1074;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1103; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1085;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086; &#1085;&#1077;&#1090;&#1088;&#1080;&#1074;&#1080;&#1072;&#1083;&#1077;&#1085;. &#1044;&#1077;&#1083;&#1086; &#1074; &#1090;&#1086;&#1084;, &#1095;&#1090;&#1086; &#1085;&#1072;&#1096; &#1087;&#1088;&#1080;&#1073;&#1086;&#1088; (GPU) &#1084;&#1086;&#1078;&#1077;&#1090; &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1090;&#1100; &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086; &#1074;&#1080;&#1076;&#1086;&#1074; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080; (&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1085;&#1072; &#1084;&#1086;&#1077;&#1084; &#1055;&#1050; &#1080;&#1093; &#1086;&#1082;&#1072;&#1079;&#1072;&#1083;&#1086;&#1089;&#1100; &#1087;&#1103;&#1090;&#1100;). &#1048;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1102; &#1086; &#1085;&#1080;&#1093; &#1084;&#1086;&#1078;&#1085;&#1086; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100; &#1074;&#1099;&#1079;&#1086;&#1074;&#1086;&#1084; <code class="codecolorer cpp default"><span class="cpp">physicalDevice.<span class="me1">getMemoryProperties</span><span class="br0">(</span><span class="br0">)</span></span></code>. &#1050;&#1072;&#1078;&#1076;&#1099;&#1081; &#1074;&#1080;&#1076; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1094;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103; &#1094;&#1077;&#1083;&#1086;&#1095;&#1080;&#1089;&#1083;&#1077;&#1085;&#1085;&#1099;&#1084; &#1080;&#1085;&#1076;&#1077;&#1082;&#1089;&#1086;&#1084; &#1086;&#1090; 0 &#1076;&#1086; 31 &#1080; &#1093;&#1072;&#1088;&#1072;&#1082;&#1090;&#1077;&#1088;&#1080;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103; &#1082;&#1086;&#1084;&#1073;&#1080;&#1085;&#1072;&#1094;&#1080;&#1077;&#1081; &#1087;&#1088;&#1080;&#1089;&#1091;&#1097;&#1080;&#1093; &#1077;&#1084;&#1091; &#1089;&#1074;&#1086;&#1081;&#1089;&#1090;&#1074;, &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1077;&#1085;&#1085;&#1099;&#1093; &#1092;&#1083;&#1072;&#1075;&#1072;&#1084;&#1080; VkMemoryPropertyFlags. &#1059;&#1087;&#1086;&#1084;&#1103;&#1085;&#1077;&#1084; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1090;&#1088;&#1080; &#1089;&#1072;&#1084;&#1099;&#1077; &#1087;&#1086;&#1085;&#1103;&#1090;&#1085;&#1099;&#1077; &#1080;&#1079; &#1085;&#1080;&#1093;:</p>
<table>
<tr>
<td style="text-align:left">VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</td>
<td style="text-align:left">&#1044;&#1086;&#1089;&#1090;&#1091;&#1087; GPU &#1082; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1089; &#1090;&#1072;&#1082;&#1080;&#1084; &#1089;&#1074;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&#1084; &#1085;&#1072;&#1080;&#1073;&#1086;&#1083;&#1077;&#1077; &#1101;&#1092;&#1092;&#1077;&#1082;&#1090;&#1080;&#1074;&#1077;&#1085;</td>
</tr>
<tr>
<td style="text-align:left">VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</td>
<td style="text-align:left">&#1055;&#1072;&#1084;&#1103;&#1090;&#1100; &#1089; &#1090;&#1072;&#1082;&#1080;&#1084; &#1089;&#1074;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&#1084; &#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100; &#1089;&#1087;&#1088;&#1086;&#1077;&#1094;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1072; &#1085;&#1072; &#1072;&#1076;&#1088;&#1077;&#1089;&#1085;&#1086;&#1077; &#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1089;&#1090;&#1074;&#1086; CPU &#1076;&#1083;&#1103; &#1095;&#1090;&#1077;&#1085;&#1080;&#1103; &#1080; &#1079;&#1072;&#1087;&#1080;&#1089;&#1080;</td>
</tr>
<tr>
<td style="text-align:left">VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</td>
<td style="text-align:left">&#1044;&#1083;&#1103; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1089; &#1090;&#1072;&#1082;&#1080;&#1084; &#1089;&#1074;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&#1084; &#1085;&#1077; &#1090;&#1088;&#1077;&#1073;&#1091;&#1102;&#1090;&#1089;&#1103; &#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1099; vkFlushMappedMemoryRanges &#1080; vkInvalidateMappedMemoryRanges &#1076;&#1083;&#1103; &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1082;&#1080; &#1082;&#1086;&#1075;&#1077;&#1088;&#1077;&#1085;&#1090;&#1085;&#1086;&#1089;&#1090;&#1080; &#1084;&#1077;&#1078;&#1076;&#1091; CPU &#1080; GPU</td>
</tr>
</table>
<p>&#1054;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103;, &#1095;&#1090;&#1086; &#1087;&#1072;&#1084;&#1103;&#1090;&#1100; &#1076;&#1083;&#1103; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100; &#1074;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1072; &#1083;&#1080;&#1096;&#1100; &#1080;&#1079; &#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1099;&#1093; &#1090;&#1080;&#1087;&#1086;&#1074; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;, &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1084;&#1099;&#1093; GPU. &#1059;&#1079;&#1085;&#1072;&#1090;&#1100; &#1080;&#1079; &#1082;&#1072;&#1082;&#1080;&#1093; &#1080;&#1084;&#1077;&#1085;&#1085;&#1086; &#1084;&#1086;&#1078;&#1085;&#1086; &#1074;&#1099;&#1079;&#1086;&#1074;&#1086;&#1084; <code class="codecolorer cpp default"><span class="cpp">logicalDevice.<span class="me1">getImageMemoryRequirements</span><span class="br0">(</span>m_Image<span class="br0">)</span></span></code>. &#1055;&#1086;&#1084;&#1080;&#1084;&#1086; &#1101;&#1090;&#1086;&#1075;&#1086; &#1082; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1076;&#1083;&#1103; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &#1085;&#1072;&#1084;&#1080; &#1084;&#1086;&#1078;&#1077;&#1090; &#1087;&#1088;&#1077;&#1076;&#1098;&#1103;&#1074;&#1083;&#1103;&#1090;&#1100;&#1089;&#1103; &#1090;&#1088;&#1077;&#1073;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077; &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1082;&#1080; &#1082;&#1072;&#1082;&#1080;&#1093;-&#1090;&#1086; &#1080;&#1079; &#1091;&#1087;&#1086;&#1084;&#1103;&#1085;&#1091;&#1090;&#1099;&#1093; &#1089;&#1074;&#1086;&#1081;&#1089;&#1090;&#1074; &#1074; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1077; &#1074;&#1099;&#1096;&#1077; (&#1074; &#1082;&#1086;&#1076;&#1077; &#1074;&#1099;&#1096;&#1077; &#1086;&#1085;&#1080; &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1077;&#1085;&#1099; &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1084; memoryPropFlags). &#1058;&#1072;&#1082;&#1080;&#1084; &#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;, &#1074;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1077; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1087;&#1088;&#1077;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074; &#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1081; &#1082;&#1086;&#1076;:</p>
<div class="codecolorer-container cpp default" style="overflow:auto;white-space:nowrap;"><div class="cpp codecolorer"><span class="co1">// ALLOCATE MEMORY</span><br>
<span class="kw4">auto</span> memoryRequirements <span class="sy1">=</span> logicalDevice.<span class="me1">getImageMemoryRequirements</span><span class="br0">(</span>m_Image<span class="br0">)</span><span class="sy4">;</span><br>
m_ImageMemory <span class="sy1">=</span> logicalDevice.<span class="me1">allocateMemory</span><span class="br0">(</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">MemoryAllocateInfo</span><br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">allocationSize</span> <span class="sy1">=</span> memoryRequirements.<span class="me1">size</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">memoryTypeIndex</span> <span class="sy1">=</span> FindMemoryTypeIndex<span class="br0">(</span>physicalDevice, memoryRequirements, memoryPropFlags<span class="br0">)</span><br>
&nbsp; &nbsp; <span class="br0">}</span><span class="br0">)</span><span class="sy4">;</span><br>
<br>
<span class="co1">// Looks for the right memory index that fits the requirements.</span><br>
<span class="co1">// Graphics cards can offer different types of memory to allocate from. Each type</span><br>
<span class="co1">// of memory varies in terms of allowed operations and performance characteristics.</span><br>
<span class="co1">// We need to combine the requirements of the buffer and our own application requirements</span><br>
<span class="co1">// to find the right type of memory to use.</span><br>
<span class="kw4">uint32_t</span> FindMemoryTypeIndex<span class="br0">(</span><br>
&nbsp; &nbsp; <span class="kw4">const</span> vk<span class="sy4">::</span><span class="me2">PhysicalDevice</span><span class="sy3">&amp;</span> physicalDevice,<br>
&nbsp; &nbsp; <span class="kw4">const</span> vk<span class="sy4">::</span><span class="me2">MemoryRequirements</span><span class="sy3">&amp;</span> bufferMemoryRequirements,<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">MemoryPropertyFlags</span> appMemoryRequirements<span class="br0">)</span><br>
<span class="br0">{</span><br>
&nbsp; &nbsp; <span class="co1">// Get properties of physical device memory</span><br>
&nbsp; &nbsp; <span class="kw4">auto</span> memoryProperties <span class="sy1">=</span> physicalDevice.<span class="me1">getMemoryProperties</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="kw4">auto</span> allowedTypes <span class="sy1">=</span> bufferMemoryRequirements.<span class="me1">memoryTypeBits</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">uint32_t</span> i <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> i <span class="sy1">&lt;</span> memoryProperties.<span class="me1">memoryTypeCount</span><span class="sy4">;</span> i<span class="sy2">++</span><span class="br0">)</span><br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span><span class="co1">// Index of memory type must match corresponding bit in allowedTypes</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">(</span>allowedTypes <span class="sy3">&amp;</span> <span class="br0">(</span><span class="nu0">1</span> <span class="sy1">&lt;&lt;</span> i<span class="br0">)</span><span class="br0">)</span> <span class="sy3">&amp;&amp;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Desired property bit flags must be part of memory type's property flags</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">(</span><span class="br0">(</span>memoryProperties.<span class="me1">memoryTypes</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">propertyFlags</span> <span class="sy3">&amp;</span> appMemoryRequirements<span class="br0">)</span> <span class="sy1">==</span> appMemoryRequirements<span class="br0">)</span><span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> i<span class="sy4">;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span><br>
&nbsp; &nbsp; <span class="br0">}</span><br>
&nbsp; &nbsp; <span class="kw1">throw</span> VkException<span class="br0">(</span>FUNCTION_INFO<span class="br0">)</span><span class="sy4">;</span><br>
<span class="br0">}</span></div></div>
<p>&#1053;&#1086; &#1074;&#1077;&#1088;&#1085;&#1077;&#1084;&#1089;&#1103; &#1082; &#1073;&#1091;&#1092;&#1077;&#1088;&#1091; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;. &#1054;&#1085; &#1089;&#1086;&#1073;&#1086;&#1081; &#1090;&#1086;&#1078;&#1077; &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090; &laquo;&#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077;&raquo;, &#1085;&#1086; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077; &#1089;&#1087;&#1077;&#1094;&#1080;&#1092;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &mdash; &#1082;&#1072;&#1078;&#1076;&#1099;&#1081; &#1087;&#1080;&#1082;&#1089;&#1077;&#1083;&#1100; &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1075;&#1086; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090; &#1085;&#1077; &#1094;&#1074;&#1077;&#1090;&#1086;&#1074;&#1099;&#1077; &#1082;&#1072;&#1085;&#1072;&#1083;&#1099;, &#1072; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099; (&#1077;&#1089;&#1083;&#1080; &#1074;&#1099; &#1079;&#1085;&#1072;&#1082;&#1086;&#1084;&#1099; &#1089; &#1082;&#1086;&#1084;&#1087;&#1100;&#1102;&#1090;&#1077;&#1088;&#1085;&#1086;&#1081; &#1075;&#1088;&#1072;&#1092;&#1080;&#1082;&#1086;&#1081;, &#1090;&#1086; &#1074;&#1072;&#1084; &#1085;&#1077; &#1085;&#1091;&#1078;&#1085;&#1086; &#1086;&#1073;&#1098;&#1103;&#1089;&#1085;&#1103;&#1090;&#1100;, &#1095;&#1090;&#1086; &#1101;&#1090;&#1086; &#1090;&#1072;&#1082;&#1086;&#1077;). &#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091; &#1085;&#1072;&#1084; &#1086;&#1089;&#1090;&#1072;&#1083;&#1086;&#1089;&#1100; &#1074;&#1099;&#1079;&#1074;&#1072;&#1090;&#1100; &#1082;&#1086;&#1085;&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1086;&#1088; &#1082;&#1083;&#1072;&#1089;&#1089;&#1072; VkImage2d &#1089;&#1086; &#1089;&#1087;&#1077;&#1094;&#1080;&#1092;&#1080;&#1095;&#1085;&#1099;&#1084;&#1080; &#1076;&#1083;&#1103; &#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099; &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;&#1084;&#1080;, &#1076;&#1083;&#1103; &#1095;&#1077;&#1075;&#1086; &#1103; &#1089;&#1086;&#1079;&#1076;&#1072;&#1083; &#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1091;&#1102; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102;:</p>
<div class="codecolorer-container cpp default" style="overflow:auto;white-space:nowrap;"><div class="cpp codecolorer"><span class="kw2">inline</span> VkImage2d CreateDepthBuffer<span class="br0">(</span><br>
&nbsp; &nbsp; <span class="kw4">const</span> vk<span class="sy4">::</span><span class="me2">PhysicalDevice</span><span class="sy3">&amp;</span> physicalDevice,<br>
&nbsp; &nbsp; <span class="kw4">const</span> vk<span class="sy4">::</span><span class="me2">Device</span><span class="sy3">&amp;</span> logicalDevice,<br>
&nbsp; &nbsp; <span class="kw4">const</span> vk<span class="sy4">::</span><span class="me2">Extent2D</span><span class="sy3">&amp;</span> imageExtent,<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">ImageUsageFlags</span> usage <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ImageUsageFlagBits</span><span class="br0">{</span><span class="br0">}</span><span class="br0">)</span><br>
<span class="br0">{</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> VkImage2d<span class="br0">(</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; physicalDevice,<br>
&nbsp; &nbsp; &nbsp; &nbsp; logicalDevice,<br>
&nbsp; &nbsp; &nbsp; &nbsp; imageExtent.<span class="me1">width</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; imageExtent.<span class="me1">height</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="coMULTI">/*format*/</span> FindDepthFormat<span class="br0">(</span>physicalDevice<span class="br0">)</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="coMULTI">/*tiling*/</span> vk<span class="sy4">::</span><span class="me2">ImageTiling</span><span class="sy4">::</span><span class="me2">eOptimal</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="coMULTI">/*useFlags*/</span> vk<span class="sy4">::</span><span class="me2">ImageUsageFlagBits</span><span class="sy4">::</span><span class="me2">eDepthStencilAttachment</span> <span class="sy3">|</span> usage,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="coMULTI">/*propFlags*/</span> vk<span class="sy4">::</span><span class="me2">MemoryPropertyFlagBits</span><span class="sy4">::</span><span class="me2">eDeviceLocal</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="coMULTI">/*aspectFlags*/</span> vk<span class="sy4">::</span><span class="me2">ImageAspectFlagBits</span><span class="sy4">::</span><span class="me2">eDepth</span><span class="br0">)</span><span class="sy4">;</span><br>
<span class="br0">}</span></div></div>
<p>&#1050;&#1090;&#1086; &#1089;&#1089;&#1099;&#1083;&#1072;&#1077;&#1090;&#1089;&#1103; &#1085;&#1072; DepthBuffer (&#1087;&#1086;&#1089;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1086;&#1084; &#1077;&#1075;&#1086; ImageView). &#1058;&#1086;&#1083;&#1100;&#1082;&#1086; &#1092;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1099; (Framebuffers) &mdash; &#1089;&#1084;. &#1076;&#1072;&#1083;&#1077;&#1077;.</p>
<h2>RenderPass</h2>
<p><a href="https://www.khronos.org/registry/vulkan/specs/1.2-extensions/html/vkspec.html#renderpass">RenderPass</a> &mdash; &#1101;&#1090;&#1086; &#1086;&#1095;&#1077;&#1088;&#1077;&#1076;&#1085;&#1072;&#1103; &#1072;&#1073;&#1089;&#1090;&#1088;&#1072;&#1082;&#1094;&#1080;&#1103;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1072;&#1103;, &#1086;&#1076;&#1085;&#1072;&#1082;&#1086;, &#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; &#1085;&#1086;&#1074;&#1086;&#1074;&#1074;&#1077;&#1076;&#1077;&#1085;&#1080;&#1077;&#1084; Vulkan. &#1054;&#1073;&#1098;&#1077;&#1082;&#1090; RenderPass &#1086;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1077;&#1090; &#1090;&#1086;, &#1095;&#1090;&#1086; &#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103; multipass rendering &mdash; &#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1082;&#1072; &#1074; &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086; &#1087;&#1088;&#1086;&#1093;&#1086;&#1076;&#1086;&#1074;. Multipass rendering &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103;, &#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1076;&#1083;&#1103; &#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1082;&#1080; &#1090;&#1077;&#1085;&#1077;&#1081; &#1083;&#1080;&#1073;&#1086; &#1076;&#1083;&#1103; &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1103; &#1090;. &#1085;. &#1101;&#1092;&#1092;&#1077;&#1082;&#1090;&#1086;&#1074; &#1087;&#1086;&#1089;&#1090;&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1080;&#1085;&#1075;&#1072;. &#1053;&#1086; &#1074; &#1087;&#1088;&#1086;&#1089;&#1090;&#1077;&#1081;&#1096;&#1077;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077; &#1076;&#1083;&#1103; &#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1082;&#1080; &#1076;&#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1095;&#1085;&#1086; &#1086;&#1076;&#1085;&#1086;&#1075;&#1086; &#1087;&#1088;&#1086;&#1093;&#1086;&#1076;&#1072;. &#1058;&#1077;&#1084; &#1085;&#1077; &#1084;&#1077;&#1085;&#1077;&#1077;, &#1080; &#1101;&#1090;&#1086;&#1090; &#1086;&#1076;&#1080;&#1085; &#1087;&#1088;&#1086;&#1093;&#1086;&#1076; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085; &#1073;&#1099;&#1090;&#1100; &#1086;&#1087;&#1080;&#1089;&#1072;&#1085; &#1074; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1077; RenderPass. &#1050;&#1072;&#1082;&#1091;&#1102; &#1078;&#1077; &#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1102; &#1086;&#1085;&#1072; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;?</p>
<p>Multipass rendering, &#1082;&#1072;&#1082; &#1091;&#1078;&#1077; &#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083;&#1086;&#1089;&#1100;, &#1089;&#1086;&#1089;&#1090;&#1086;&#1080;&#1090; &#1080;&#1079; &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1080;&#1093; &#1087;&#1088;&#1086;&#1093;&#1086;&#1076;&#1086;&#1074; (subpass). &#1050;&#1072;&#1078;&#1076;&#1099;&#1081; &#1087;&#1088;&#1086;&#1093;&#1086;&#1076; &mdash; &#1101;&#1090;&#1086; &#1079;&#1072;&#1087;&#1091;&#1089;&#1082; &#1087;&#1072;&#1081;&#1087;&#1083;&#1072;&#1081;&#1085;&#1072; (pipeline), &#1090;. &#1077;. &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1099;, &#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1097;&#1077;&#1081; &#1080;&#1079; &#1088;&#1103;&#1076;&#1072; &#1092;&#1080;&#1082;&#1089;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1093; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081; (vertex assembly, clipping, rasterization &#1080; &#1087;&#1088;.) &#1080; &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1091;&#1077;&#1084;&#1099;&#1093; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081;, &#1090;&#1086; &#1073;&#1080;&#1096;&#1100; &#1096;&#1077;&#1081;&#1076;&#1077;&#1088;&#1086;&#1074;. &#1056;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1086;&#1084; &#1087;&#1088;&#1086;&#1093;&#1086;&#1076;&#1072; &#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1077; (&#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1082;&#1072;) &#1082;&#1072;&#1082;&#1086;&#1075;&#1086; &#1083;&#1080;&#1073;&#1086; &#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &#1080;&#1083;&#1080; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; (&#1094;&#1074;&#1077;&#1090;&#1072;, &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099; &#1080; &#1087;&#1088;.). &#1042;&#1086;&#1079;&#1100;&#1084;&#1077;&#1084; &#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088; shadow mapping: &#1086;&#1085; &#1086;&#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; &#1074; &#1076;&#1074;&#1072; &#1087;&#1088;&#1086;&#1093;&#1086;&#1076;&#1072;. &#1042; 1-&#1086;&#1084; &#1087;&#1088;&#1086;&#1093;&#1086;&#1076;&#1077; &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090;&#1089;&#1103; &laquo;&#1090;&#1077;&#1085;&#1077;&#1074;&#1086;&#1081;&raquo; &#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;, &#1074;&#1086; 2-&#1086;&#1084; &#1087;&#1088;&#1086;&#1093;&#1086;&#1076;&#1077; &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090;&#1089;&#1103; &#1095;&#1090;&#1077;&#1085;&#1080;&#1077; &#1080;&#1079; &#1101;&#1090;&#1086;&#1075;&#1086; &laquo;&#1090;&#1077;&#1085;&#1077;&#1074;&#1086;&#1075;&#1086;&raquo; &#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099; (&#1082;&#1072;&#1082; &#1080;&#1079; &#1090;&#1077;&#1082;&#1089;&#1090;&#1091;&#1088;&#1099;) &#1080; &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1103;&#1102;&#1090;&#1089;&#1103; &#1073;&#1091;&#1092;&#1077;&#1088; &#1094;&#1074;&#1077;&#1090;&#1072; &#1080; &laquo;&#1086;&#1073;&#1099;&#1095;&#1085;&#1099;&#1081;&raquo; &#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;. &#1058;&#1072;&#1082;&#1080;&#1084; &#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;, &#1082;&#1072;&#1078;&#1076;&#1099;&#1081; &#1087;&#1088;&#1086;&#1093;&#1086;&#1076; (subpass) &#1093;&#1072;&#1088;&#1072;&#1082;&#1090;&#1077;&#1088;&#1080;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103; &#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1081; &#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1077;&#1081;:</p>
<ul>
<li>&#1053;&#1072;&#1073;&#1086;&#1088; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;, &#1080;&#1079; &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093; &#1086;&#1085; &#1095;&#1080;&#1090;&#1072;&#1077;&#1090; (input attachments)</li>
<li>&#1053;&#1072;&#1073;&#1086;&#1088; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;, &#1074; &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1086;&#1085; &#1087;&#1080;&#1096;&#1077;&#1090; (color attachments, depth&amp;sol;stencil attachments)</li>
<li>Pipeline, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1079;&#1072;&#1087;&#1091;&#1089;&#1082;&#1072;&#1077;&#1090;&#1089;&#1103; &#1080;, &#1089;&#1086;&#1073;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;, &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090; &#1074;&#1099;&#1096;&#1077;&#1091;&#1087;&#1086;&#1084;&#1103;&#1085;&#1091;&#1090;&#1099;&#1077; &#1076;&#1074;&#1072; &#1087;&#1091;&#1085;&#1082;&#1090;&#1072;</li>
</ul>
<p>&#1042;&#1086;&#1090; &#1101;&#1090;&#1072; &#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1103; &#1080; &#1086;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1077; RenderPass. &#1044;&#1083;&#1103; &#1095;&#1077;&#1075;&#1086; &#1075;&#1086;&#1088;&#1086;&#1076;&#1080;&#1090;&#1100; &#1076;&#1072;&#1085;&#1085;&#1099;&#1081; &#1086;&#1075;&#1086;&#1088;&#1086;&#1076; &mdash; &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1086; &#1074; &#1089;&#1087;&#1077;&#1094;&#1080;&#1092;&#1080;&#1082;&#1072;&#1094;&#1080;&#1080; Vulkan:</p>
<blockquote><p>
By describing a complete set of subpasses in advance, render passes provide the implementation an opportunity to optimize the storage and transfer of attachment data between subpasses.<br>
In practice, this means that subpasses with a simple framebuffer-space dependency may be merged into a single tiled rendering pass, keeping the attachment data on-chip for the duration of a render pass instance. However, it is also quite common for a render pass to only contain a single subpass.
</p></blockquote>
<p>&#1054;&#1090;&#1076;&#1077;&#1083;&#1100;&#1085;&#1099;&#1077; &#1089;&#1090;&#1072;&#1076;&#1080;&#1080; &#1088;&#1072;&#1079;&#1083;&#1080;&#1095;&#1085;&#1099;&#1093; subpass&rsquo;&#1086;&#1074; &#1084;&#1086;&#1075;&#1091;&#1090; &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1090;&#1100;&#1089;&#1103; GPU &#1087;&#1072;&#1088;&#1072;&#1083;&#1083;&#1077;&#1083;&#1100;&#1085;&#1086;, &#1095;&#1090;&#1086; &#1085;&#1077;&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086; &#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088; &#1074; OpenGL. &#1053;&#1086; &#1101;&#1090;&#1086; &#1074;&#1085;&#1086;&#1089;&#1080;&#1090; &#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1091;&#1102; &#1089;&#1083;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1100;, &#1089;&#1074;&#1103;&#1079;&#1072;&#1085;&#1085;&#1091;&#1102; &#1089; &#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086;&#1089;&#1090;&#1100;&#1102; &#1089;&#1080;&#1085;&#1093;&#1088;&#1086;&#1085;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080; subpass&rsquo;&#1086;&#1074; (&#1072;&#1085;&#1072;&#1083;&#1086;&#1075;&#1080;&#1095;&#1085;&#1086; &#1090;&#1086;&#1084;&#1091;, &#1082;&#1072;&#1082; &#1089;&#1080;&#1085;&#1093;&#1088;&#1086;&#1085;&#1080;&#1079;&#1080;&#1088;&#1091;&#1102;&#1090;&#1089;&#1103; &#1087;&#1086;&#1090;&#1086;&#1082;&#1080; &#1074; &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1072;&#1093;) &mdash; &#1101;&#1090;&#1086; &#1076;&#1077;&#1083;&#1072;&#1077;&#1090;&#1089;&#1103; &#1087;&#1091;&#1090;&#1077;&#1084; &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1103; &#1090;. &#1085;. &#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1077;&#1081; &#1084;&#1077;&#1078;&#1076;&#1091; subpass&rsquo;&#1072;&#1084;&#1080; (<a href="https://www.khronos.org/registry/vulkan/specs/1.2-extensions/html/vkspec.html#synchronization-dependencies">subpass dependencies</a>). &#1055;&#1086; &#1089;&#1091;&#1090;&#1080; &#1101;&#1090;&#1086; &#1086;&#1079;&#1085;&#1072;&#1095;&#1072;&#1077;&#1090;, &#1095;&#1090;&#1086; &#1076;&#1083;&#1103; &#1082;&#1072;&#1078;&#1076;&#1086;&#1081; &#1087;&#1072;&#1088;&#1099; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086; &#1080;&#1076;&#1091;&#1097;&#1080;&#1093; subpass&rsquo;&#1086;&#1074; &#1074;&#1099; &#1076;&#1086;&#1083;&#1078;&#1085;&#1099; &#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1100;, &#1082;&#1072;&#1082;&#1080;&#1077; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080; &#1080; &#1085;&#1072; &#1082;&#1072;&#1082;&#1086;&#1081; &#1089;&#1090;&#1072;&#1076;&#1080;&#1080; &#1087;&#1072;&#1081;&#1087;&#1083;&#1072;&#1081;&#1085;&#1072; &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090; 1-&#1081; subpass &#1085;&#1072;&#1076; &#1089;&#1074;&#1086;&#1080;&#1084;&#1080; &#1074;&#1099;&#1093;&#1086;&#1076;&#1085;&#1099;&#1084;&#1080; attachment&rsquo;&#1072;&#1084;&#1080;, &#1080;&#1079; &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093; &#1095;&#1080;&#1090;&#1072;&#1077;&#1090; 2-&#1081; subpass; &#1080; &#1090;&#1086;, &#1082;&#1072;&#1082;&#1080;&#1077; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080; &#1080; &#1085;&#1072; &#1082;&#1072;&#1082;&#1086;&#1081; &#1089;&#1090;&#1072;&#1076;&#1080;&#1080; &#1087;&#1072;&#1081;&#1087;&#1083;&#1072;&#1081;&#1085;&#1072; &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090; 2-&#1081; subpass &#1085;&#1072;&#1076; &#1089;&#1074;&#1086;&#1080;&#1084;&#1080; &#1074;&#1093;&#1086;&#1076;&#1085;&#1099;&#1084;&#1080; attachment&rsquo;&#1072;&#1084;&#1080;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1087;&#1088;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090; &#1077;&#1084;&#1091; 1-&#1081; subpass. &#1047;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080; &#1084;&#1077;&#1078;&#1076;&#1091; subpass&rsquo;&#1072;&#1084;&#1080; &#1086;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1102;&#1090;&#1089;&#1103; &#1087;&#1088;&#1080; &#1087;&#1086;&#1084;&#1086;&#1097;&#1080; &#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088; <em>vk::SubpassDependency</em>. &#1047;&#1072;&#1084;&#1077;&#1090;&#1080;&#1084;, &#1095;&#1090;&#1086; &#1082;&#1072;&#1078;&#1076;&#1072;&#1103; &#1089;&#1090;&#1072;&#1076;&#1080;&#1103; &#1087;&#1072;&#1081;&#1087;&#1083;&#1072;&#1081;&#1085;&#1072; &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090; &#1083;&#1080;&#1096;&#1100; &#1086;&#1075;&#1088;&#1072;&#1085;&#1080;&#1095;&#1077;&#1085;&#1085;&#1099;&#1081; &#1085;&#1072;&#1073;&#1086;&#1088; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1081;.</p>
<p>&#1045;&#1097;&#1077; &#1086;&#1076;&#1085;&#1072; &#1089;&#1083;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1100; &#1089;&#1074;&#1103;&#1079;&#1072;&#1085;&#1072; &#1089; &#1090;&#1077;&#1084;, &#1095;&#1090;&#1086; &#1082;&#1072;&#1078;&#1076;&#1099;&#1081; attachment &#1084;&#1086;&#1078;&#1077;&#1090; &#1084;&#1077;&#1085;&#1103;&#1090;&#1100; &#1089;&#1074;&#1086;&#1081; layout &#1087;&#1088;&#1080; &#1087;&#1077;&#1088;&#1077;&#1093;&#1086;&#1076;&#1077; &#1086;&#1090; &#1086;&#1076;&#1085;&#1086;&#1075;&#1086; subpass&rsquo;&#1072; &#1082; &#1076;&#1088;&#1091;&#1075;&#1086;&#1084;&#1091;. &#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091; &#1076;&#1083;&#1103; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; subpass&rsquo;&#1072; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085; &#1073;&#1099;&#1090;&#1100; &#1091;&#1082;&#1072;&#1079;&#1072;&#1085; layout &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; attachment&rsquo;&#1072;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1090;&#1086;&#1090; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085; &#1080;&#1084;&#1077;&#1090;&#1100; &#1074;&#1086; &#1074;&#1088;&#1077;&#1084;&#1103; &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1103; &#1076;&#1072;&#1085;&#1085;&#1086;&#1075;&#1086; subpass&rsquo;&#1072;. &#1045;&#1089;&#1083;&#1080; &#1074;&#1079;&#1103;&#1090;&#1100; &#1090;&#1086;&#1090; &#1078;&#1077; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088; &#1089; shadow mapping, &#1090;&#1086; &#1074; &#1085;&#1077;&#1084; &#1074;&#1086; &#1074;&#1088;&#1077;&#1084;&#1103; 1-&#1086;&#1075;&#1086; subpass&rsquo;&#1072; &laquo;&#1090;&#1077;&#1085;&#1077;&#1074;&#1086;&#1081;&raquo; &#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085; &#1080;&#1084;&#1077;&#1090;&#1100; layout &#1087;&#1086;&#1076; &#1085;&#1072;&#1079;&#1074;&#1072;&#1085;&#1080;&#1077;&#1084; <em>DepthStencilAttachmentOptimal</em> (&#1086;&#1087;&#1090;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081; &#1076;&#1083;&#1103; &#1079;&#1072;&#1087;&#1080;&#1089;&#1080; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;), &#1072; &#1074;&#1086; &#1074;&#1088;&#1077;&#1084;&#1103; 2-&#1086;&#1075;&#1086; subpass&rsquo;&#1072; &#1090;&#1086;&#1090; &#1078;&#1077; &#1089;&#1072;&#1084;&#1099;&#1081; &#1073;&#1091;&#1092;&#1077;&#1088; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085; &#1080;&#1084;&#1077;&#1090;&#1100; layout <em>ShaderReadOnlyOptimal</em> (&#1086;&#1087;&#1090;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081; &#1076;&#1083;&#1103; &#1095;&#1090;&#1077;&#1085;&#1080;&#1103; &#1074; &#1096;&#1077;&#1081;&#1076;&#1077;&#1088;&#1077;). &#1055;&#1077;&#1088;&#1077;&#1093;&#1086;&#1076;&#1099; &#1084;&#1077;&#1078;&#1076;&#1091; layout&rsquo;&#1072;&#1084;&#1080; &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1102;&#1090;&#1089;&#1103; &#1072;&#1074;&#1090;&#1086;&#1084;&#1072;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;.</p>
<p>&#1040; &#1090;&#1077;&#1087;&#1077;&#1088;&#1100; &#1087;&#1083;&#1086;&#1093;&#1080;&#1077; &#1085;&#1086;&#1074;&#1086;&#1089;&#1090;&#1080;: </p>
<blockquote><p>&hellip; fragments for pixel (x,y,layer) in one subpass can only read attachment contents written by previous subpasses at the same (x,y,layer) location</p></blockquote>
<p>&#1069;&#1090;&#1086; &#1079;&#1085;&#1072;&#1095;&#1080;&#1090;, &#1095;&#1090;&#1086; shadow mapping &#1086;&#1076;&#1085;&#1080;&#1084; RenderPass&rsquo;&#1086;&#1084; &#1084;&#1099; &#1074;&#1089;&#1077;-&#1090;&#1072;&#1082;&#1080; &#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1085;&#1077; &#1089;&#1084;&#1086;&#1078;&#1077;&#1084;, &#1087;&#1086;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1091; shadow mapping&rsquo;&#1091; &#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086; &#1095;&#1080;&#1090;&#1072;&#1090;&#1100; &#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1086;&#1083;&#1100;&#1085;&#1099;&#1077; &#1092;&#1088;&#1072;&#1075;&#1084;&#1077;&#1085;&#1090;&#1099; &#1080;&#1079; &laquo;&#1090;&#1077;&#1085;&#1077;&#1074;&#1086;&#1075;&#1086;&raquo; &#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;, &#1072; &#1085;&#1072;&#1084; &#1088;&#1072;&#1079;&#1088;&#1077;&#1096;&#1077;&#1085;&#1086; &#1095;&#1080;&#1090;&#1072;&#1090;&#1100; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1092;&#1088;&#1072;&#1075;&#1084;&#1077;&#1085;&#1090; &#1089; &#1090;&#1077;&#1084;&#1080; &#1078;&#1077; &#1082;&#1086;&#1086;&#1088;&#1076;&#1080;&#1085;&#1072;&#1090;&#1072;&#1084;&#1080;, &#1095;&#1090;&#1086; &#1080; &#1085;&#1072;&#1096; &#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1081; &#1092;&#1088;&#1072;&#1075;&#1084;&#1077;&#1085;&#1090; &#1074; &#1073;&#1091;&#1092;&#1077;&#1088;&#1077; &#1094;&#1074;&#1077;&#1090;&#1072;. &#1053;&#1091; &#1076;&#1072; &#1085;&#1080;&#1095;&#1077;&#1075;&#1086;, &#1079;&#1072;&#1090;&#1086; &#1101;&#1092;&#1092;&#1077;&#1082;&#1090;&#1099; &#1087;&#1086;&#1089;&#1090;&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1080;&#1085;&#1075;&#1072; &#1084;&#1099; &#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100; &#1089;&#1084;&#1086;&#1078;&#1077;&#1084;.</p>
<p>&#1050;&#1072;&#1078;&#1076;&#1099;&#1081; subpass &#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1094;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103; &#1094;&#1077;&#1083;&#1086;&#1095;&#1080;&#1089;&#1083;&#1077;&#1085;&#1085;&#1099;&#1084; &#1080;&#1085;&#1076;&#1077;&#1082;&#1089;&#1086;&#1084; (0, 1, 2 &#1080; &#1090;. &#1076;.). &#1054;&#1076;&#1085;&#1072;&#1082;&#1086; &#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090; &#1085;&#1077;&#1082;&#1080;&#1081; &laquo;&#1087;&#1089;&#1077;&#1074;&#1076;&#1086;subpass&raquo;, &#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1094;&#1080;&#1088;&#1091;&#1077;&#1084;&#1099;&#1081; &#1082;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1086;&#1081; VK_SUBPASS_EXTERNAL. &#1057;&#1086;&#1075;&#1083;&#1072;&#1089;&#1085;&#1086; &#1089;&#1087;&#1077;&#1094;&#1080;&#1092;&#1080;&#1082;&#1072;&#1094;&#1080;&#1080;, &#1101;&#1090;&#1086;&#1090; &#1087;&#1089;&#1077;&#1074;&#1076;&#1086;subpass <em>includes commands that occur earlier in submission order than the vkCmdBeginRenderPass used to begin the render pass instance</em> &#1080;&#1083;&#1080; <em>includes commands that occur later in submission order than the vkCmdEndRenderPass used to end the render pass instance</em>. &#1058;&#1072;&#1082; &#1080;&#1083;&#1080; &#1080;&#1085;&#1072;&#1095;&#1077;, &#1101;&#1090;&#1086;&#1090; subpass &#1076;&#1086;&#1083;&#1078;&#1077;&#1085; &#1092;&#1080;&#1075;&#1091;&#1088;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100; &#1074; 1-&#1081; &#1080; &#1074; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1077;&#1081; &#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080; &#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072; subpass dependencies.</p>
<p>&#1048;&#1090;&#1072;&#1082;, &#1087;&#1088;&#1080;&#1074;&#1077;&#1076;&#1077;&#1084; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; &#1076;&#1083;&#1103; &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1103; &#1087;&#1088;&#1086;&#1089;&#1090;&#1077;&#1081;&#1096;&#1077;&#1075;&#1086; RenderPass&rsquo;&#1072; &#1089; &#1076;&#1074;&#1091;&#1084;&#1103; attachment&rsquo;&#1072;&#1084;&#1080; (color buffer &amp; depth buffer) &#1080; &#1086;&#1076;&#1085;&#1080;&#1084; subpass&rsquo;&#1086;&#1084;:</p>
<div class="codecolorer-container cpp default" style="overflow:auto;white-space:nowrap;"><div class="cpp codecolorer"><span class="co1">// THE FOLLOWING IS PSEUDOCODE!</span><br>
<br>
<span class="co1">// Field</span><br>
vk<span class="sy4">::</span><span class="me2">RenderPass</span> m_RenderPass<span class="sy4">;</span><br>
<br>
<span class="co1">// Constructor</span><br>
m_RenderPass<span class="br0">(</span>CreateRenderPassOneSubpass<span class="br0">(</span><br>
&nbsp; &nbsp; m_VkGraphicsContext.<span class="me1">LogicalDevice</span><span class="br0">(</span><span class="br0">)</span>,<br>
&nbsp; &nbsp; m_SwapChainImageFormat,<br>
&nbsp; &nbsp; depthBufferImageFormat<span class="br0">)</span><span class="br0">)</span><br>
<br>
<span class="co1">// Function</span><br>
<span class="kw2">inline</span> vk<span class="sy4">::</span><span class="me2">RenderPass</span> CreateRenderPassOneSubpass<span class="br0">(</span><br>
&nbsp; &nbsp; <span class="kw4">const</span> vk<span class="sy4">::</span><span class="me2">Device</span><span class="sy3">&amp;</span> logicalDevice,<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">Format</span> colorImageFormat,<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">Format</span> depthImageFormat<span class="br0">)</span><br>
<span class="br0">{</span><br>
&nbsp; &nbsp; <span class="co1">// --- ATTACHMENTS ---</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// Color attachment of the render pass</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">AttachmentDescription</span> colorAttachment<br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">format</span> <span class="sy1">=</span> colorImageFormat, <span class="co1">// Format to use for attachment (here we are rendering directly into a swap chain so we need to take its format)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">samples</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">SampleCountFlagBits</span><span class="sy4">::</span><span class="me2">e1</span>, &nbsp; <span class="co1">// Number of samples to write for multisampling (we are not using any multisampling here so we just use one sample)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">loadOp</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">AttachmentLoadOp</span><span class="sy4">::</span><span class="me2">eClear</span>, &nbsp; <span class="co1">// What to do with the attached framebuffer before rendering</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">storeOp</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">AttachmentStoreOp</span><span class="sy4">::</span><span class="me2">eStore</span>, <span class="co1">// What to do with the attached framebuffer after rendering</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// When an attachment has a depth format (and potentially also a stencil component) load and store ops refer</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// only to the depth component. If a stencil is present, stencil values are treated the way stencil load and</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// store ops describe. For color attachments, stencil ops are not relevant.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">//.stencilLoadOp = vk::AttachmentLoadOp::eDontCare, &nbsp; // What to do with the stencil buffer before rendering</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">//.stencilStoreOp = vk::AttachmentStoreOp::eDontCare, // What to do with the stencil buffer after rendering</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Framebuffer data will be stored as an image, but images can be given different data layouts</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// to give optimal use for certain operations.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Layout is an internal memory arrangement of an image. Image data may be organized in such a way</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// that neighboring &quot;image pixels&quot; are also neighbors in memory, which can increase cache hits</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// (faster memory reading) when image is used as a source of data (that is, during texture sampling).</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// But caching is not necessary when the image is used as a target for drawing operations, and the</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// memory for that image may be organized in a totally different way. Image may have linear layout</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// (which gives the CPU ability to read or populate image's memory contents) or optimal layout</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// (which is optimized for performance but is also hardware/vendor dependent). So some hardware may</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// have special memory organization for some types of operations; other hardware may be operations-</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// agnostic. Some of the memory layouts may be better suited for some intended image &quot;usages.&quot;</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Or from the other side, some usages may require specific memory layouts. There is also a general</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// layout that is compatible with all types of operations. But from the performance point of view,</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// it is always best to set the layout appropriate for an intended image usage and it is application's</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// responsibility to inform the driver about transitions.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">initialLayout</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ImageLayout</span><span class="sy4">::</span><span class="me2">eUndefined</span>, &nbsp;<span class="co1">// INITIAL layout informs the hardware about the layout the application &quot;provides&quot; the given attachment with.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">finalLayout</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ImageLayout</span><span class="sy4">::</span><span class="me2">ePresentSrcKHR</span> <span class="co1">// The final layout is the layout the given attachment will be transitioned into (automatically) AT THE END of a render pass.</span><br>
&nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// Depth attachment of the render pass</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">AttachmentDescription</span> depthAttachment<br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">format</span> <span class="sy1">=</span> depthImageFormat, &nbsp; &nbsp; &nbsp; <span class="co1">// Format to use for attachment (here we are rendering directly into a swap chain so we need to take its format)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">samples</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">SampleCountFlagBits</span><span class="sy4">::</span><span class="me2">e1</span>, &nbsp; &nbsp; &nbsp;<span class="co1">// Number of samples to write for multisampling (we are not using any multisampling here so we just use one sample)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">loadOp</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">AttachmentLoadOp</span><span class="sy4">::</span><span class="me2">eClear</span>, &nbsp; &nbsp; &nbsp;<span class="co1">// What to do with the attached framebuffer before rendering</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">storeOp</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">AttachmentStoreOp</span><span class="sy4">::</span><span class="me2">eDontCare</span>, <span class="co1">// What to do with the attached framebuffer after rendering</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// When an attachment has a depth format (and potentially also a stencil component) load and store ops refer</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// only to the depth component. If a stencil is present, stencil values are treated the way stencil load and</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// store ops describe.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">stencilLoadOp</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">AttachmentLoadOp</span><span class="sy4">::</span><span class="me2">eDontCare</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">stencilStoreOp</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">AttachmentStoreOp</span><span class="sy4">::</span><span class="me2">eDontCare</span>,<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">initialLayout</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ImageLayout</span><span class="sy4">::</span><span class="me2">eUndefined</span>, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// INITIAL layout informs the hardware about the layout the application &quot;provides&quot; the given attachment with.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">finalLayout</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ImageLayout</span><span class="sy4">::</span><span class="me2">eDepthStencilAttachmentOptimal</span> &nbsp;<span class="co1">// The final layout is the layout the given attachment will be transitioned into (automatically) AT THE END of a render pass.</span><br>
&nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// --- REFERENCES ---</span><br>
&nbsp; &nbsp; <span class="co1">// Every subpass references one or more of the attachments.</span><br>
&nbsp; &nbsp; <span class="co1">// These references are themselves AttachmentReference structs.</span><br>
&nbsp; &nbsp; <span class="co1">// There is a separation between a whole render pass and its subpasses because each subpass may use</span><br>
&nbsp; &nbsp; <span class="co1">// multiple attachments in a different way, that is, in one subpass we are rendering into one color</span><br>
&nbsp; &nbsp; <span class="co1">// attachment but in the next subpass we are reading from this attachment. In this way, we can prepare</span><br>
&nbsp; &nbsp; <span class="co1">// a list of all attachments used in the whole render pass, and at the same time we can specify how</span><br>
&nbsp; &nbsp; <span class="co1">// each attachment will be used in each subpass. And as each subpass may use a given attachment in</span><br>
&nbsp; &nbsp; <span class="co1">// its own way, we must also specify each image&rsquo;s layout for each subpass.</span><br>
&nbsp; &nbsp; <span class="co1">// So before we can specify a description of all subpasses(an array with elements of type</span><br>
&nbsp; &nbsp; <span class="co1">// VkSubpassDescription) we must create references for each attachment used in each subpass.</span><br>
&nbsp; &nbsp; <span class="co1">// And this is what the color_attachment_references variable was created for.</span><br>
<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">AttachmentReference</span> colorAttachmentRef<br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// specifies which attachment to reference by its index in the attachment descriptions array</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">attachment</span> <span class="sy1">=</span> <span class="nu0">0</span>,<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Requested (required) layout the attachment will use DURING a given subpass.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// The hardware will perform an automatic transition into a provided layout just</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// before a given subpass.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">layout</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ImageLayout</span><span class="sy4">::</span><span class="me2">eColorAttachmentOptimal</span><br>
&nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">AttachmentReference</span> depthAttachmentRef<br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// specifies which attachment to reference by its index in the attachment descriptions array</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">attachment</span> <span class="sy1">=</span> <span class="nu0">1</span>,<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Requested (required) layout the attachment will use DURING a given subpass.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// The hardware will perform an automatic transition into a provided layout just</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// before a given subpass.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">layout</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">ImageLayout</span><span class="sy4">::</span><span class="me2">eDepthStencilAttachmentOptimal</span><br>
&nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// --- SUBPASSES ---</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// Information about a particular subpass the render pass is using.</span><br>
&nbsp; &nbsp; <span class="co1">// A subpass consists of drawing operations that use (more or less) the same attachments.</span><br>
&nbsp; &nbsp; <span class="co1">// Each of these drawing operations may read from some input attachments and render data</span><br>
&nbsp; &nbsp; <span class="co1">// into some other (color, depth, stencil) attachments.</span><br>
&nbsp; &nbsp; <span class="co1">// Each subpass uses its own unique pipeline (the one currently bound to the pipelineBindPoint).</span><br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">SubpassDescription</span> subpass<br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Type of pipeline in which this subpass will be used (graphics</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// or compute). Our example, of course, uses a graphics pipeline.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">pipelineBindPoint</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">PipelineBindPoint</span><span class="sy4">::</span><span class="me2">eGraphics</span>,<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Array describing (pointing to) attachments which will be used</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// as color render targets (that image will be rendered into).</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// The index of the attachment in this array is directly referenced from the</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// fragment shader with the layout(location = 0) out vec4 outColor directive.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">colorAttachmentCount</span> <span class="sy1">=</span> <span class="nu0">1</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">pColorAttachments</span> <span class="sy1">=</span> <span class="sy3">&amp;</span>colorAttachmentRef,<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Unlike color attachments, a subpass can only use a single depth (+stencil) attachment.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">pDepthStencilAttachment</span> <span class="sy1">=</span> <span class="sy3">&amp;</span>depthAttachmentRef<br>
&nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// When multiple subpasses are in use, the driver needs to be told the relationship between them. A subpass can depend</span><br>
&nbsp; &nbsp; <span class="co1">// on operations which were submitted outside the current render pass, or be the source on which later rendering depends.</span><br>
&nbsp; &nbsp; <span class="co1">// Most commonly, the need is to ensure that the fragment shader from an earlier subpass has completed rendering (to the</span><br>
&nbsp; &nbsp; <span class="co1">// current tile, on a tiler) before the next subpass starts to try to read that data.</span><br>
&nbsp; &nbsp; <span class="co1">// https://developer.samsung.com/galaxy-gamedev/resources/articles/renderpasses.html</span><br>
&nbsp; &nbsp; std<span class="sy4">::</span><span class="me2">array</span><span class="sy1">&lt;</span>vk<span class="sy4">::</span><span class="me2">SubpassDependency</span>, <span class="nu0">2</span><span class="sy1">&gt;</span> subpassDependencies<br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// External --&gt; Subpass 0</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">SubpassDependency</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">srcSubpass</span> <span class="sy1">=</span> VK_SUBPASS_EXTERNAL, <span class="co1">// The subpass index of the 1st subpass in the dependency. Subpass index (VK_SUBPASS_EXTERNAL = special value meaning outside of renderpass).</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">dstSubpass</span> <span class="sy1">=</span> <span class="nu0">0</span>, <span class="co1">// The subpass index of the 2nd subpass in the dependency</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// The synchronization scope of the 1st set of commands. What pipeline stage must have completed for the dependency</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">srcStageMask</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">PipelineStageFlagBits</span><span class="sy4">::</span><span class="me2">eBottomOfPipe</span>, <span class="co1">// eBottomOfPipe specifies all operations performed by all commands supported on the queue it is used with</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// The synchronization scope of the 2nd set of commands. What pipeline stage is waiting on the dependency</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">dstStageMask</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">PipelineStageFlagBits</span><span class="sy4">::</span><span class="me2">eColorAttachmentOutput</span> <span class="sy3">|</span> vk<span class="sy4">::</span><span class="me2">PipelineStageFlagBits</span><span class="sy4">::</span><span class="me2">eEarlyFragmentTests</span>,<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Memory access scope of the 1st set of commands</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">srcAccessMask</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">AccessFlagBits</span><span class="sy4">::</span><span class="me2">eNoneKHR</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Memory access scope of the 2nd set of commands</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">dstAccessMask</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">AccessFlagBits</span><span class="sy4">::</span><span class="me2">eColorAttachmentWrite</span> <span class="sy3">|</span> vk<span class="sy4">::</span><span class="me2">AccessFlagBits</span><span class="sy4">::</span><span class="me2">eDepthStencilAttachmentWrite</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Subpass 0 --&gt; External</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">SubpassDependency</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">srcSubpass</span> <span class="sy1">=</span> <span class="nu0">0</span>, &nbsp;<span class="co1">// The subpass index of the 1st subpass in the dependency</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">dstSubpass</span> <span class="sy1">=</span> VK_SUBPASS_EXTERNAL, <span class="co1">// The subpass index of the 2nd subpass in the dependency. Subpass index (VK_SUBPASS_EXTERNAL = special value meaning outside of renderp</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// The synchronization scope of the 1st set of commands. What pipeline stage must have completed for the dependency</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">srcStageMask</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">PipelineStageFlagBits</span><span class="sy4">::</span><span class="me2">eColorAttachmentOutput</span> <span class="sy3">|</span> vk<span class="sy4">::</span><span class="me2">PipelineStageFlagBits</span><span class="sy4">::</span><span class="me2">eEarlyFragmentTests</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// The synchronization scope of the 2nd set of commands. What pipeline stage is waiting on the dependency</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">dstStageMask</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">PipelineStageFlagBits</span><span class="sy4">::</span><span class="me2">eTopOfPipe</span>, <span class="co1">// eTopOfPipe specifies all operations performed by all commands supported on the queue it is used with</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Memory access scope of the 1st set of commands</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">srcAccessMask</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">AccessFlagBits</span><span class="sy4">::</span><span class="me2">eColorAttachmentWrite</span> <span class="sy3">|</span> vk<span class="sy4">::</span><span class="me2">AccessFlagBits</span><span class="sy4">::</span><span class="me2">eDepthStencilAttachmentWrite</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Memory access scope of the 2nd set of commands</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">dstAccessMask</span> <span class="sy1">=</span> vk<span class="sy4">::</span><span class="me2">AccessFlagBits</span><span class="sy4">::</span><span class="me2">eNoneKHR</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,<br>
&nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="co1">// --- RENDER PASS ---</span><br>
<br>
&nbsp; &nbsp; std<span class="sy4">::</span><span class="me2">array</span><span class="sy1">&lt;</span>vk<span class="sy4">::</span><span class="me2">AttachmentDescription</span>, <span class="nu0">2</span><span class="sy1">&gt;</span> attachments<br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; colorAttachment, <span class="co1">// 0 (position is important, because AttachmentReferences refer to it)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; depthAttachment &nbsp;<span class="co1">// 1 (position is important, because AttachmentReferences refer to it)</span><br>
&nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">RenderPassCreateInfo</span> renderPassCreateInfo<br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">attachmentCount</span> <span class="sy1">=</span> attachments.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span>, <span class="co1">// Number of all different attachments (elements in pAttachments array) used during whole render pass</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">pAttachments</span> <span class="sy1">=</span> attachments.<span class="me1">data</span><span class="br0">(</span><span class="br0">)</span>, &nbsp; &nbsp;<span class="co1">// Array specifying all attachments used in a render pass</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">subpassCount</span> <span class="sy1">=</span> <span class="nu0">1</span>, &nbsp; &nbsp; &nbsp;<span class="co1">// Number of subpasses a render pass consists of</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">pSubpasses</span> <span class="sy1">=</span> <span class="sy3">&amp;</span>subpass, <span class="co1">// Array with descriptions of all subpasses</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">dependencyCount</span> <span class="sy1">=</span> subpassDependencies.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">pDependencies</span> <span class="sy1">=</span> subpassDependencies.<span class="me1">data</span><span class="br0">(</span><span class="br0">)</span><br>
&nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; <span class="kw1">return</span> logicalDevice.<span class="me1">createRenderPass</span><span class="br0">(</span>renderPassCreateInfo<span class="br0">)</span><span class="sy4">;</span><br>
<span class="br0">}</span><br>
<br>
<span class="co1">// Destructor</span><br>
logicalDevice.<span class="me1">destroyRenderPass</span><span class="br0">(</span>m_RenderPass<span class="br0">)</span><span class="sy4">;</span></div></div>
<p>&#1050;&#1090;&#1086; &#1089;&#1089;&#1099;&#1083;&#1072;&#1077;&#1090;&#1089;&#1103; &#1085;&#1072; RenderPass. &#1060;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1099; (&#1089;&#1084;. &#1085;&#1080;&#1078;&#1077;) &#1080; &#1087;&#1072;&#1081;&#1087;&#1083;&#1072;&#1081;&#1085; (vk::Pipeline).</p>
<h2>Framebuffers</h2>
<p>&#1048;&#1090;&#1072;&#1082;, &#1084;&#1099; &#1080;&#1084;&#1077;&#1077;&#1084; Swapchain, &#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1097;&#1080;&#1081; &#1080;&#1079; &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1080;&#1093; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; &#1094;&#1074;&#1077;&#1090;&#1072;. &#1057;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086; &#1085;&#1072;&#1084; &#1087;&#1086;&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;? &#1057;&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1078;&#1077;, &#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1081; &#1091; &#1085;&#1072;&#1089; &#1074; &#1089;&#1074;&#1086;&#1087;&#1095;&#1077;&#1081;&#1085;&#1077; &mdash; &#1087;&#1086;&#1090;&#1086;&#1084;&#1091;, &#1095;&#1090;&#1086; &#1082;&#1072;&#1078;&#1076;&#1086;&#1077; &#1080;&#1079; &#1101;&#1090;&#1080;&#1093; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1081; &#1084;&#1099; &#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1099;&#1074;&#1072;&#1077;&#1084; &#1074; &#1086;&#1073;&#1097;&#1077;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077; &#1087;&#1072;&#1088;&#1072;&#1083;&#1083;&#1077;&#1083;&#1100;&#1085;&#1086;, &#1080; &#1074; &#1101;&#1090;&#1086;&#1081; &#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1082;&#1077; &#1079;&#1072;&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1086;&#1074;&#1072;&#1085; &#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;, &#1074; &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1074; &#1093;&#1086;&#1076;&#1077; &#1086;&#1090;&#1088;&#1080;&#1089;&#1086;&#1074;&#1082;&#1080; &#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1086;&#1076;&#1080;&#1090;&#1089;&#1103; &#1080; &#1095;&#1090;&#1077;&#1085;&#1080;&#1077;, &#1080; &#1079;&#1072;&#1087;&#1080;&#1089;&#1100;. &#1045;&#1089;&#1083;&#1080; &#1091; &#1074;&#1072;&#1089; &#1087;&#1086;&#1090;&#1077;&#1085;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1086; &#1077;&#1089;&#1090;&#1100; N &#1087;&#1072;&#1088;&#1072;&#1083;&#1083;&#1077;&#1083;&#1100;&#1085;&#1099;&#1093; &#1087;&#1086;&#1090;&#1086;&#1082;&#1086;&#1074; (&#1074; GPU), &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1087;&#1080;&#1096;&#1091;&#1090; &#1080; &#1095;&#1080;&#1090;&#1072;&#1102;&#1090; &#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;, &#1090;&#1086; &#1083;&#1091;&#1095;&#1096;&#1077; &#1073;&#1099; &#1074;&#1072;&#1084; &#1080;&#1084;&#1077;&#1090;&#1100; N &#1086;&#1090;&#1076;&#1077;&#1083;&#1100;&#1085;&#1099;&#1093; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;. &#1057;&#1082;&#1072;&#1079;&#1072;&#1085;&#1085;&#1086;&#1077; &#1086;&#1090;&#1085;&#1086;&#1089;&#1080;&#1090;&#1089;&#1103; &#1085;&#1077; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1082; &#1073;&#1091;&#1092;&#1077;&#1088;&#1091; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;, &#1085;&#1086; &#1080; &#1082; &#1083;&#1102;&#1073;&#1099;&#1084; &#1088;&#1077;&#1089;&#1091;&#1088;&#1089;&#1072;&#1084; (&#1073;&#1091;&#1092;&#1077;&#1088; &#1094;&#1074;&#1077;&#1090;&#1072;, uniform buffer), &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1085;&#1077; &#1103;&#1074;&#1083;&#1103;&#1102;&#1090;&#1089;&#1103; read-only.</p>
<p>&#1052;&#1099; &#1090;&#1072;&#1082;&#1078;&#1077; &#1079;&#1085;&#1072;&#1077;&#1084;, &#1095;&#1090;&#1086; &#1085;&#1072;&#1096; RenderPass &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090; &#1088;&#1086;&#1074;&#1085;&#1086; &#1076;&#1074;&#1072; attachment&rsquo;&#1072;: &#1086;&#1076;&#1080;&#1085; &#1080;&#1079; &#1085;&#1080;&#1093; &mdash; &#1073;&#1091;&#1092;&#1077;&#1088; &#1094;&#1074;&#1077;&#1090;&#1072; (ColorAttachmentOutput), &#1074;&#1090;&#1086;&#1088;&#1086;&#1081; &mdash; &#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099; (DepthAttachment). &#1047;&#1072;&#1084;&#1077;&#1090;&#1080;&#1084;, &#1095;&#1090;&#1086; RenderPass &#1085;&#1080;&#1082;&#1086;&#1080;&#1084; &#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084; &#1085;&#1077; &#1089;&#1089;&#1099;&#1083;&#1072;&#1077;&#1090;&#1089;&#1103; &#1085;&#1080; &#1085;&#1072; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1103; &#1080;&#1079; Swapchain&rsquo;&#1072;, &#1085;&#1080; &#1085;&#1072; &#1085;&#1072;&#1096;&#1080; DepthBuffer&rsquo;&#1099; &mdash; &#1086;&#1085; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1089;&#1087;&#1077;&#1094;&#1080;&#1092;&#1080;&#1094;&#1080;&#1088;&#1091;&#1077;&#1090; &#1090;&#1086;, &#1082;&#1072;&#1082;&#1086;&#1075;&#1086; &#1088;&#1086;&#1076;&#1072; attachment&rsquo;&#1099; &#1077;&#1084;&#1091; &#1085;&#1091;&#1078;&#1085;&#1099; &#1080; &#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086; &#1080;&#1093;. &#1050;&#1072;&#1082;&#1080;&#1084; &#1078;&#1077; &#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084; GPU &#1091;&#1079;&#1085;&#1072;&#1077;&#1090;, &#1082;&#1072;&#1082;&#1080;&#1077; &#1082;&#1086;&#1085;&#1082;&#1088;&#1077;&#1090;&#1085;&#1086; &#1073;&#1091;&#1092;&#1077;&#1088;&#1099; &#1085;&#1072;&#1076;&#1086; &#1073;&#1091;&#1076;&#1077;&#1090; &laquo;&#1087;&#1088;&#1080;attach&rsquo;&#1080;&#1090;&#1100;&raquo; &#1082; RenderPass&rsquo;&#1091;. &#1040; &#1074;&#1086;&#1090; &#1082;&#1072;&#1082; &#1088;&#1072;&#1079; &#1089;&#1089;&#1099;&#1083;&#1082;&#1080; &#1085;&#1072; &#1101;&#1090;&#1080; &#1073;&#1091;&#1092;&#1077;&#1088;&#1099; &#1080; &#1093;&#1088;&#1072;&#1085;&#1103;&#1090; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; &#1087;&#1086;&#1076; &#1085;&#1072;&#1079;&#1074;&#1072;&#1085;&#1080;&#1077;&#1084; vk::Framebuffer (&#1087;&#1086;&#1076; &#1089;&#1089;&#1099;&#1083;&#1082;&#1072;&#1084;&#1080; &#1084;&#1099; &#1087;&#1086;&#1085;&#1080;&#1084;&#1072;&#1077;&#1084; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1099; &#1090;&#1080;&#1087;&#1072; vk::ImageView). &#1057;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086; &#1078;&#1077; &#1073;&#1091;&#1076;&#1077;&#1090; &#1090;&#1072;&#1082;&#1080;&#1093; &#1092;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;? &#1050;&#1086;&#1085;&#1077;&#1095;&#1085;&#1086; &#1089;&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1078;&#1077;, &#1089;&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1081; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090; Swapchain. &#1050;&#1072;&#1078;&#1076;&#1099;&#1081; &#1092;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088; &#1073;&#1091;&#1076;&#1077;&#1090; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1090;&#1100; &#1089;&#1089;&#1099;&#1083;&#1082;&#1091; &#1085;&#1072; &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1077;&#1077; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077; &#1080;&#1079; Swapchain &#1080; &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1081; &#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099; (&#1056;&#1080;&#1089;. 2). &#1055;&#1088;&#1086;&#1089;&#1090;&#1086; &#1076;&#1083;&#1103; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1072;: &#1077;&#1089;&#1083;&#1080; &#1073;&#1099; &#1084;&#1099; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1083;&#1080; &#1074;&#1089;&#1077;&#1075;&#1086; &#1086;&#1076;&#1080;&#1085; &#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;, &#1090;&#1086; &#1085;&#1072;&#1096;&#1080; &#1092;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1099; &#1074;&#1099;&#1075;&#1083;&#1103;&#1076;&#1077;&#1083;&#1080; &#1073;&#1099; &#1090;&#1072;&#1082;, &#1082;&#1072;&#1082; &#1087;&#1086;&#1082;&#1072;&#1079;&#1072;&#1085;&#1086; &#1085;&#1072; &#1056;&#1080;&#1089;. 3.</p>
<table>
<td>
<figure id="attachment_1892" aria-describedby="caption-attachment-1892" style="width: 400px" class="wp-caption alignnone"><img decoding="async" src="/blog/wp-content/uploads/2021/07/FramebuffersManyDepthBuffers-1024x797.jpg" alt="" width="847" height="659" class="size-large wp-image-1892"><figcaption id="caption-attachment-1892" class="wp-caption-text">&#1056;&#1080;&#1089;. 2 &mdash; &#1060;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1099;: &#1084;&#1085;&#1086;&#1075;&#1086; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; &#1094;&#1074;&#1077;&#1090;&#1072; &#1080; &#1084;&#1085;&#1086;&#1075;&#1086; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;</figcaption></figure>
</td>
<td>
<figure id="attachment_1731" aria-describedby="caption-attachment-1731" style="width: 400px" class="wp-caption alignnone"><img decoding="async" src="/blog/wp-content/uploads/2021/07/Framebuffers-1024x797.jpg" alt="" width="847" height="659" class="size-large wp-image-1731"><figcaption id="caption-attachment-1731" class="wp-caption-text">&#1056;&#1080;&#1089;. 3 &mdash; &#1060;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1099;: &#1084;&#1085;&#1086;&#1075;&#1086; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; &#1094;&#1074;&#1077;&#1090;&#1072; &#1080; &#1086;&#1076;&#1080;&#1085; &#1073;&#1091;&#1092;&#1077;&#1088; &#1075;&#1083;&#1091;&#1073;&#1080;&#1085;&#1099;</figcaption></figure>
</td>
</table>
<p>&#1048;&#1090;&#1072;&#1082;, &#1074;&#1086;&#1090; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1103;&#1103; &#1074; &#1101;&#1090;&#1086;&#1081; &#1079;&#1072;&#1084;&#1077;&#1090;&#1082;&#1077; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103; &#1076;&#1083;&#1103; &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1103; &#1092;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;:</p>
<div class="codecolorer-container cpp default" style="overflow:auto;white-space:nowrap;"><div class="cpp codecolorer"><span class="co1">// THE FOLLOWING IS PSEUDOCODE!</span><br>
<br>
<span class="co1">// Field</span><br>
std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>vk<span class="sy4">::</span><span class="me2">Framebuffer</span><span class="sy1">&gt;</span> m_Framebuffers<span class="sy4">;</span><br>
<br>
<span class="co1">// Constructor</span><br>
m_Framebuffers<span class="br0">(</span>CreateFramebuffers<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><br>
<br>
<span class="co1">// Function</span><br>
std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>vk<span class="sy4">::</span><span class="me2">Framebuffer</span><span class="sy1">&gt;</span> CreateFramebuffers<span class="br0">(</span><span class="br0">)</span><br>
<span class="br0">{</span><br>
&nbsp; &nbsp; std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>vk<span class="sy4">::</span><span class="me2">Framebuffer</span><span class="sy1">&gt;</span> framebuffers<span class="sy4">;</span><br>
&nbsp; &nbsp; framebuffers.<span class="me1">reserve</span><span class="br0">(</span>m_SwapchainImages.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">size_t</span> i <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> i <span class="sy1">&lt;</span> m_SwapchainImages.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> i<span class="sy2">++</span><span class="br0">)</span><br>
&nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; std<span class="sy4">::</span><span class="me2">array</span><span class="sy1">&lt;</span>vk<span class="sy4">::</span><span class="me2">ImageView</span>, <span class="nu0">2</span><span class="sy1">&gt;</span> attachments<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_SwapchainImages<span class="br0">[</span>i<span class="br0">]</span>, &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// 0 (position is important - it should match that of the render pass in vk::RenderPassCreateInfo::pAttachments)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_DepthBuffers<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ImageView</span><span class="br0">(</span><span class="br0">)</span> <span class="co1">// 1 (position is important - it should match that of the render pass in vk::RenderPassCreateInfo::pAttachments)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; vk<span class="sy4">::</span><span class="me2">FramebufferCreateInfo</span> framebufferCreateInfo<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Render Pass with which the framebuffer needs to be compatible. You can only use a framebuffer</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// with the render passes that it is compatible with, which roughly means that they use the same</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// number and type of attachments.</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// https://vulkan-tutorial.com/Drawing_a_triangle/Drawing/Framebuffers</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">renderPass</span> <span class="sy1">=</span> m_RenderPass,<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">attachmentCount</span> <span class="sy1">=</span> <span class="kw2">static_cast</span><span class="sy1">&lt;</span><span class="kw4">uint32_t</span><span class="sy1">&gt;</span><span class="br0">(</span>attachments.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">pAttachments</span> <span class="sy1">=</span> attachments.<span class="me1">data</span><span class="br0">(</span><span class="br0">)</span>, <span class="co1">// List of attachments (1:1 with Render Pass)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">width</span> <span class="sy1">=</span> SwapChainExtent<span class="br0">(</span><span class="br0">)</span>.<span class="me1">width</span>, &nbsp; <span class="co1">// Framebuffer width</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">height</span> <span class="sy1">=</span> SwapChainExtent<span class="br0">(</span><span class="br0">)</span>.<span class="me1">height</span>, <span class="co1">// Framebuffer height</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">layers</span> <span class="sy1">=</span> <span class="nu0">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// Framebuffer layers</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span><span class="sy4">;</span><br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; framebuffers.<span class="me1">push_back</span><span class="br0">(</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_VkGraphicsContext.<span class="me1">LogicalDevice</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">createFramebuffer</span><span class="br0">(</span>framebufferCreateInfo<span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span><br>
&nbsp; &nbsp; <span class="br0">}</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> framebuffers<span class="sy4">;</span><br>
<span class="br0">}</span><br>
<br>
<span class="co1">// Destructor</span><br>
<span class="kw1">for</span> <span class="br0">(</span><span class="kw4">auto</span><span class="sy3">&amp;</span> framebuffer <span class="sy4">:</span> m_Framebuffers<span class="br0">)</span><br>
&nbsp; &nbsp; logicalDevice.<span class="me1">destroyFramebuffer</span><span class="br0">(</span>framebuffer<span class="br0">)</span><span class="sy4">;</span></div></div>
<p>&#1050;&#1090;&#1086; &#1089;&#1089;&#1099;&#1083;&#1072;&#1077;&#1090;&#1089;&#1103; &#1085;&#1072; &#1092;&#1088;&#1077;&#1081;&#1084;&#1073;&#1091;&#1092;&#1077;&#1088;(&#1099;). &#1058;&#1086;&#1083;&#1100;&#1082;&#1086; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1072; vk::RenderPassBeginInfo, &#1082;&#1086;&#1090;&#1086;&#1088;&#1072;&#1103; &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; vk::CommandBuffer.beginRenderPass(), &#1082;&#1086;&#1090;&#1086;&#1088;&#1091;&#1102; &#1084;&#1099; &#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1077;&#1084;, &#1082;&#1086;&#1075;&#1076;&#1072; &#1079;&#1072;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1077;&#1084; &#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1099; &#1074; &#1073;&#1091;&#1092;&#1077;&#1088; &#1082;&#1086;&#1084;&#1072;&#1085;&#1076; (&#1086;&#1073; &#1101;&#1090;&#1086;&#1084; &#1088;&#1077;&#1095;&#1100; &#1087;&#1086;&#1081;&#1076;&#1077;&#1090; &#1074; &#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1081; &#1079;&#1072;&#1084;&#1077;&#1090;&#1082;&#1077;). &#1057;&#1086;&#1073;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086; &#1074;&#1099;&#1079;&#1086;&#1074; &#1101;&#1090;&#1086;&#1081; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; &#1080; &#1079;&#1072;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1077;&#1090; &#1074; &#1073;&#1091;&#1092;&#1077;&#1088; &#1082;&#1086;&#1084;&#1072;&#1085;&#1076; &#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1102; &#1086; &#1090;&#1086;&#1084;, &#1082;&#1072;&#1082;&#1086;&#1081; RenderPass &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100;, &#1080; &#1082;&#1072;&#1082;&#1080;&#1077; &#1073;&#1091;&#1092;&#1077;&#1088;&#1099; &#1082; &#1085;&#1077;&#1084;&#1091; &#1087;&#1088;&#1080;attach&rsquo;&#1080;&#1090;&#1100;.</p>
<p>&#1050;&#1072;&#1082; &#1086;&#1073;&#1099;&#1095;&#1085;&#1086;, &#1074; &#1082;&#1086;&#1085;&#1094;&#1077; &#1087;&#1088;&#1080;&#1074;&#1086;&#1078;&#1091; &#1088;&#1080;&#1089;&#1091;&#1085;&#1086;&#1082; &#1074;&#1079;&#1072;&#1080;&#1084;&#1086;&#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1077;&#1081; &#1084;&#1077;&#1078;&#1076;&#1091; &#1080;&#1079;&#1091;&#1095;&#1077;&#1085;&#1085;&#1099;&#1084;&#1080; &#1085;&#1072;&#1084;&#1080; &#1085;&#1072; &#1076;&#1072;&#1085;&#1085;&#1099;&#1081; &#1084;&#1086;&#1084;&#1077;&#1085;&#1090; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;&#1084;&#1080; Vulkan:<br>
<figure id="attachment_1860" aria-describedby="caption-attachment-1860" style="width: 1788px" class="wp-caption alignnone"><img loading="lazy" decoding="async" src="/blog/wp-content/uploads/2021/10/VulkanObjectModel2.jpg" alt="" width="1788" height="573" class="size-full wp-image-1860"><figcaption id="caption-attachment-1860" class="wp-caption-text">&#1056;&#1080;&#1089;. 4 &mdash; &#1054;&#1073;&#1098;&#1077;&#1082;&#1090;&#1085;&#1072;&#1103; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100;</figcaption></figure></p>
<p>&#1055;&#1088;&#1086;&#1076;&#1086;&#1083;&#1078;&#1077;&#1085;&#1080;&#1077; &#1089;&#1083;&#1077;&#1076;&#1091;&#1077;&#1090;&hellip;</p>
			</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links"><a href="/blog/category/%d0%b1%d0%b5%d0%b7-%d1%80%d1%83%d0%b1%d1%80%d0%b8%d0%ba%d0%b8/" rel="category tag">&#1041;&#1077;&#1079; &#1088;&#1091;&#1073;&#1088;&#1080;&#1082;&#1080;</a></span><span class="tags-links"><a href="/blog/tag/c-c/" rel="tag">C/C++</a>, <a href="/blog/tag/vulkan/" rel="tag">Vulkan</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->


			
	<nav class="navigation post-navigation" aria-label="&#1047;&#1072;&#1087;&#1080;&#1089;&#1080;">
		<h2 class="screen-reader-text">&#1053;&#1072;&#1074;&#1080;&#1075;&#1072;&#1094;&#1080;&#1103; &#1087;&#1086; &#1079;&#1072;&#1087;&#1080;&#1089;&#1103;&#1084;</h2>
		<div class="nav-links"><div class="nav-previous"><a href="/blog/2021/07/16/vulkan-2/" rel="prev">Vulkan Learning &mdash; 2. Surface. Physical Device. Logical Device. Command Queues</a></div><div class="nav-next"><a href="/blog/2021/08/13/vulkan-4/" rel="next">Vulkan Learning &mdash; 4. Pipeline. Descriptor Sets. Push Constants</a></div></div>
	</nav>
			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">&#1044;&#1086;&#1073;&#1072;&#1074;&#1080;&#1090;&#1100; &#1082;&#1086;&#1084;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1080;&#1081; <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/2021/07/22/vulkan-3/#respond" style="display:none;">&#1054;&#1090;&#1084;&#1077;&#1085;&#1080;&#1090;&#1100; &#1086;&#1090;&#1074;&#1077;&#1090;</a></small></h3><form action="/blog/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">&#1042;&#1072;&#1096; &#1072;&#1076;&#1088;&#1077;&#1089; email &#1085;&#1077; &#1073;&#1091;&#1076;&#1077;&#1090; &#1086;&#1087;&#1091;&#1073;&#1083;&#1080;&#1082;&#1086;&#1074;&#1072;&#1085;.</span> <span class="required-field-message">&#1054;&#1073;&#1103;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1077; &#1087;&#1086;&#1083;&#1103; &#1087;&#1086;&#1084;&#1077;&#1095;&#1077;&#1085;&#1099; <span class="required">*</span></span></p><p class="comment-form-comment"><label for="comment">&#1050;&#1086;&#1084;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1080;&#1081; <span class="required">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required></textarea></p><p class="comment-form-author"><label for="author">&#1048;&#1084;&#1103; <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" autocomplete="name" required></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" autocomplete="email" required></p>
<p class="comment-form-url"><label for="url">&#1057;&#1072;&#1081;&#1090;</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" autocomplete="url"></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"> <label for="wp-comment-cookies-consent">&#1057;&#1086;&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100; &#1084;&#1086;&#1105; &#1080;&#1084;&#1103;, email &#1080; &#1072;&#1076;&#1088;&#1077;&#1089; &#1089;&#1072;&#1081;&#1090;&#1072; &#1074; &#1101;&#1090;&#1086;&#1084; &#1073;&#1088;&#1072;&#1091;&#1079;&#1077;&#1088;&#1077; &#1076;&#1083;&#1103; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1093; &#1084;&#1086;&#1080;&#1093; &#1082;&#1086;&#1084;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1080;&#1077;&#1074;.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="&#1054;&#1090;&#1087;&#1088;&#1072;&#1074;&#1080;&#1090;&#1100; &#1082;&#1086;&#1084;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1080;&#1081;"> <input type="hidden" name="comment_post_ID" value="1733" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->

<div id="sidebar-primary" class="widget-area" role="complementary">
	    <aside id="block-2" class="widget widget_block widget_search"><form role="search" method="get" action="/blog/" class="wp-block-search__button-outside wp-block-search__text-button wp-block-search"><label class="wp-block-search__label" for="wp-block-search__input-1">&#1055;&#1086;&#1080;&#1089;&#1082;</label><div class="wp-block-search__inside-wrapper "><input class="wp-block-search__input" id="wp-block-search__input-1" placeholder="" value="" type="search" name="s" required><button aria-label="&#1055;&#1086;&#1080;&#1089;&#1082;" class="wp-block-search__button wp-element-button" type="submit">&#1055;&#1086;&#1080;&#1089;&#1082;</button></div></form></aside><aside id="block-8" class="widget widget_block widget_tag_cloud"><p class="wp-block-tag-cloud"><a href="/blog/tag/net/" class="tag-cloud-link tag-link-3 tag-link-position-1" style="font-size: 11.652173913043pt;" aria-label=".NET (3 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">.NET</a>
<a href="/blog/tag/apache/" class="tag-cloud-link tag-link-4 tag-link-position-2" style="font-size: 10.191304347826pt;" aria-label="Apache (2 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">Apache</a>
<a href="/blog/tag/assembler/" class="tag-cloud-link tag-link-26 tag-link-position-3" style="font-size: 15.304347826087pt;" aria-label="Assembler (7 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;)">Assembler</a>
<a href="/blog/tag/blogging/" class="tag-cloud-link tag-link-27 tag-link-position-4" style="font-size: 10.191304347826pt;" aria-label="Blogging (2 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">Blogging</a>
<a href="/blog/tag/bochs/" class="tag-cloud-link tag-link-6 tag-link-position-5" style="font-size: 10.191304347826pt;" aria-label="Bochs (2 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">Bochs</a>
<a href="/blog/tag/c/" class="tag-cloud-link tag-link-8 tag-link-position-6" style="font-size: 10.191304347826pt;" aria-label="C# (2 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">C#</a>
<a href="/blog/tag/c-c/" class="tag-cloud-link tag-link-7 tag-link-position-7" style="font-size: 22pt;" aria-label="C/C++ (27 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;)">C/C++</a>
<a href="/blog/tag/cmake/" class="tag-cloud-link tag-link-9 tag-link-position-8" style="font-size: 8pt;" aria-label="cmake (1 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;)">cmake</a>
<a href="/blog/tag/coursera/" class="tag-cloud-link tag-link-11 tag-link-position-9" style="font-size: 10.191304347826pt;" aria-label="Coursera (2 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">Coursera</a>
<a href="/blog/tag/cygwin/" class="tag-cloud-link tag-link-12 tag-link-position-10" style="font-size: 11.652173913043pt;" aria-label="Cygwin (3 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">Cygwin</a>
<a href="/blog/tag/education/" class="tag-cloud-link tag-link-28 tag-link-position-11" style="font-size: 12.869565217391pt;" aria-label="Education (4 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">Education</a>
<a href="/blog/tag/git/" class="tag-cloud-link tag-link-13 tag-link-position-12" style="font-size: 10.191304347826pt;" aria-label="Git (2 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">Git</a>
<a href="/blog/tag/javascript/" class="tag-cloud-link tag-link-14 tag-link-position-13" style="font-size: 8pt;" aria-label="JavaScript (1 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;)">JavaScript</a>
<a href="/blog/tag/machine-learning/" class="tag-cloud-link tag-link-15 tag-link-position-14" style="font-size: 10.191304347826pt;" aria-label="Machine Learning (2 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">Machine Learning</a>
<a href="/blog/tag/miscelaneous/" class="tag-cloud-link tag-link-29 tag-link-position-15" style="font-size: 17.495652173913pt;" aria-label="Miscelaneous (11 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;)">Miscelaneous</a>
<a href="/blog/tag/mysql/" class="tag-cloud-link tag-link-16 tag-link-position-16" style="font-size: 8pt;" aria-label="MySQL (1 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;)">MySQL</a>
<a href="/blog/tag/opengl/" class="tag-cloud-link tag-link-17 tag-link-position-17" style="font-size: 17.008695652174pt;" aria-label="OpenGL (10 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;)">OpenGL</a>
<a href="/blog/tag/php/" class="tag-cloud-link tag-link-18 tag-link-position-18" style="font-size: 10.191304347826pt;" aria-label="PHP (2 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">PHP</a>
<a href="/blog/tag/physics/" class="tag-cloud-link tag-link-30 tag-link-position-19" style="font-size: 12.869565217391pt;" aria-label="Physics (4 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">Physics</a>
<a href="/blog/tag/powershell/" class="tag-cloud-link tag-link-19 tag-link-position-20" style="font-size: 10.191304347826pt;" aria-label="PowerShell (2 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">PowerShell</a>
<a href="/blog/tag/python/" class="tag-cloud-link tag-link-20 tag-link-position-21" style="font-size: 8pt;" aria-label="Python (1 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;)">Python</a>
<a href="/blog/tag/ue4/" class="tag-cloud-link tag-link-21 tag-link-position-22" style="font-size: 10.191304347826pt;" aria-label="UE4 (2 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">UE4</a>
<a href="/blog/tag/vulkan/" class="tag-cloud-link tag-link-22 tag-link-position-23" style="font-size: 15.913043478261pt;" aria-label="Vulkan (8 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;)">Vulkan</a>
<a href="/blog/tag/winapi/" class="tag-cloud-link tag-link-23 tag-link-position-24" style="font-size: 11.652173913043pt;" aria-label="WinAPI (3 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">WinAPI</a>
<a href="/blog/tag/wordpress/" class="tag-cloud-link tag-link-24 tag-link-position-25" style="font-size: 12.869565217391pt;" aria-label="WordPress (4 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;)">WordPress</a>
<a href="/blog/tag/x86/" class="tag-cloud-link tag-link-25 tag-link-position-26" style="font-size: 15.304347826087pt;" aria-label="x86 (7 &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;)">x86</a></p></aside><aside id="block-14" class="widget widget_block">
<ul class="wp-block-social-links is-layout-flex wp-block-social-links-is-layout-flex">

</ul>
</aside>	</div><!-- #sidebar-primary -->
</div><!-- .inner-wrapper --></div><!-- .container --></div><!-- #content -->
	<footer id="colophon" class="site-footer" role="contentinfo"><div class="container">    
	    	    	      <div class="copyright">
	        &#1040;&#1074;&#1090;&#1086;&#1088;&#1089;&#1082;&#1080;&#1077; &#1087;&#1088;&#1072;&#1074;&#1072; &#1079;&#1072;&#1097;&#1080;&#1097;&#1077;&#1085;&#1099;.	      </div><!-- .copyright -->
	    	    <div class="site-info">
	      <a href="https://ru.wordpress.org/">&#1056;&#1072;&#1073;&#1086;&#1090;&#1072;&#1077;&#1090; &#1085;&#1072; WordPress</a>
	      <span class="sep"> | </span>
			Education Hub &#1072;&#1074;&#1090;&#1086;&#1088;: <a href="https://wenthemes.com/" rel="designer" target="_blank">WEN Themes</a>	    </div><!-- .site-info -->
	    	</div><!-- .container --></footer><!-- #colophon -->
</div><!-- #page --><a href="#page" class="scrollup" id="btn-scrollup"><i class="fa fa-chevron-up"></i></a>
<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/dvsav.ru\/*"},{"not":{"href_matches":["\/dvsav.ru\/wp-*.php","\/dvsav.ru\/wp-admin\/*","\/dvsav.ru\/wp-content\/uploads\/*","\/dvsav.ru\/wp-content\/*","\/dvsav.ru\/wp-content\/plugins\/*","\/dvsav.ru\/wp-content\/themes\/education-hub\/*","\/dvsav.ru\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<script type="text/javascript" src="/blog/wp-includes/js/dist/hooks.min.js?ver=4d63a3d491d11ffd8ac6" id="wp-hooks-js"></script>
<script type="text/javascript" src="/blog/wp-includes/js/dist/i18n.min.js?ver=5e580eb46a90c2b997e6" id="wp-i18n-js"></script>
<script type="text/javascript" id="wp-i18n-js-after">
/* <![CDATA[ */
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
/* ]]> */
</script>
<script type="text/javascript" src="/blog/wp-content/plugins/contact-form-7/includes/swv/js/index.js?ver=6.1.1" id="swv-js"></script>
<script type="text/javascript" id="contact-form-7-js-translations">
/* <![CDATA[ */
( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "contact-form-7", {"translation-revision-date":"2025-08-05 08:59:32+0000","generator":"GlotPress\/4.0.1","domain":"messages","locale_data":{"messages":{"":{"domain":"messages","plural-forms":"nplurals=3; plural=(n % 10 == 1 && n % 100 != 11) ? 0 : ((n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 12 || n % 100 > 14)) ? 1 : 2);","lang":"ru"},"This contact form is placed in the wrong place.":["\u042d\u0442\u0430 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u0430\u044f \u0444\u043e\u0440\u043c\u0430 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0430 \u0432 \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u043c \u043c\u0435\u0441\u0442\u0435."],"Error:":["\u041e\u0448\u0438\u0431\u043a\u0430:"]}},"comment":{"reference":"includes\/js\/index.js"}} );
/* ]]> */
</script>
<script type="text/javascript" id="contact-form-7-js-before">
/* <![CDATA[ */
var wpcf7 = {
    "api": {
        "root": "http:\/\/localhost\/dvsav.ru\/wp-json\/",
        "namespace": "contact-form-7\/v1"
    }
};
/* ]]> */
</script>
<script type="text/javascript" src="/blog/wp-content/plugins/contact-form-7/includes/js/index.js?ver=6.1.1" id="contact-form-7-js"></script>
<script type="text/javascript" src="/blog/wp-content/themes/education-hub/js/skip-link-focus-fix.min.js?ver=20130115" id="education-hub-skip-link-focus-fix-js"></script>
<script type="text/javascript" src="/blog/wp-content/themes/education-hub/third-party/cycle2/js/jquery.cycle2.min.js?ver=2.1.6" id="cycle2-js"></script>
<script type="text/javascript" src="/blog/wp-content/themes/education-hub/js/custom.min.js?ver=1.0" id="education-hub-custom-js"></script>
<script type="text/javascript" id="education-hub-navigation-js-extra">
/* <![CDATA[ */
var EducationHubScreenReaderText = {"expand":"<span class=\"screen-reader-text\">\u0440\u0430\u0441\u043a\u0440\u044b\u0442\u044c \u0434\u043e\u0447\u0435\u0440\u043d\u0435\u0435 \u043c\u0435\u043d\u044e<\/span>","collapse":"<span class=\"screen-reader-text\">\u0441\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0434\u043e\u0447\u0435\u0440\u043d\u0435\u0435 \u043c\u0435\u043d\u044e<\/span>"};
/* ]]> */
</script>
<script type="text/javascript" src="/blog/wp-content/themes/education-hub/js/navigation.min.js?ver=20120206" id="education-hub-navigation-js"></script>
<script type="text/javascript" src="/blog/wp-includes/js/comment-reply.min.js?ver=6.8.2" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
</body>
</html>
